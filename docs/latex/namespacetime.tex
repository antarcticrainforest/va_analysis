\hypertarget{namespacetime}{}\section{time Module Reference}
\label{namespacetime}\index{time@{time}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespacetime_a29670e6cf798cee7d9e33201b38f9507}{days\+\_\+to\+\_\+date} (S\+T\+Y\+E\+AR, S\+T\+M\+O\+N\+TH, S\+T\+D\+AY, D\+A\+YS, Y\+Y\+YY, MO, DD, HH, MM, SS)
\item 
integer(kind=ik4) function \hyperlink{namespacetime_a7c66adfc707644b0644b33e1557f1486}{date\+\_\+time\+\_\+to\+\_\+unix} (Y\+Y\+YY, MO, DD, HH, MM, SS)
\item 
logical function \hyperlink{namespacetime_ac7f82d40fd2b49e7e9025b103e88555c}{leapyear} (Y\+E\+AR)
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{time@{time}!date\+\_\+time\+\_\+to\+\_\+unix@{date\+\_\+time\+\_\+to\+\_\+unix}}
\index{date\+\_\+time\+\_\+to\+\_\+unix@{date\+\_\+time\+\_\+to\+\_\+unix}!time@{time}}
\subsubsection[{\texorpdfstring{date\+\_\+time\+\_\+to\+\_\+unix(\+Y\+Y\+Y\+Y, M\+O, D\+D, H\+H, M\+M, S\+S)}{date_time_to_unix(YYYY, MO, DD, HH, MM, SS)}}]{\setlength{\rightskip}{0pt plus 5cm}integer (kind=ik4) function time\+::date\+\_\+time\+\_\+to\+\_\+unix (
\begin{DoxyParamCaption}
\item[{integer (kind=ik4), intent(in), optional}]{Y\+Y\+YY, }
\item[{integer (kind=ik4), intent(in), optional}]{MO, }
\item[{integer (kind=ik4), intent(in), optional}]{DD, }
\item[{integer (kind=ik4), intent(in), optional}]{HH, }
\item[{integer (kind=ik4), intent(in), optional}]{MM, }
\item[{integer (kind=ik4), intent(in), optional}]{SS}
\end{DoxyParamCaption}
)}\hypertarget{namespacetime_a7c66adfc707644b0644b33e1557f1486}{}\label{namespacetime_a7c66adfc707644b0644b33e1557f1486}


Definition at line 90 of file time.\+f90.


\begin{DoxyCode}
90 
91 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}, \textcolor{keywordtype}{OPTIONAL}    :: yyyy                     \textcolor{comment}{! The year.}
92 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}, \textcolor{keywordtype}{OPTIONAL}    :: mo                       \textcolor{comment}{! The month.}
93 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}, \textcolor{keywordtype}{OPTIONAL}    :: dd                       \textcolor{comment}{! The day.}
94 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}, \textcolor{keywordtype}{OPTIONAL}    :: hh                       \textcolor{comment}{! The hour.}
95 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}, \textcolor{keywordtype}{OPTIONAL}    :: mm                       \textcolor{comment}{! The minute.}
96 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}, \textcolor{keywordtype}{OPTIONAL}    :: ss                       \textcolor{comment}{! The second.}
97 
98 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(6)}            :: datetime                 \textcolor{comment}{! Parts of the date and time.}
99 \textcolor{keywordtype}{INTEGER (KIND=IK4)}                          :: yycnt                    \textcolor{comment}{! Year counter.}
100 \textcolor{keywordtype}{INTEGER (KIND=IK4)}                          :: mocnt                    \textcolor{comment}{! Month counter.}
101 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(12)}           :: mdays = (/ 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 /)
102 \textcolor{keywordtype}{INTEGER (KIND=IK4)}                          :: utime                    \textcolor{comment}{! UNIX time.}
103 
104 \textcolor{comment}{!}
105 \textcolor{comment}{! Set the date and time parts (and use default values if they are not specified by the user).}
106 \textcolor{comment}{!}
107 \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(yyyy)) \textcolor{keywordflow}{THEN}
108     datetime(1) = yyyy
109 \textcolor{keywordflow}{ELSE}
110     datetime(1) = 1970
111 \textcolor{keywordflow}{ENDIF}
112 
113 \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(mo)) \textcolor{keywordflow}{THEN}
114     datetime(2) = mo
115 \textcolor{keywordflow}{ELSE}
116     datetime(2) = 1
117 \textcolor{keywordflow}{ENDIF}
118 
119 \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(dd)) \textcolor{keywordflow}{THEN}
120     datetime(3) = dd
121 \textcolor{keywordflow}{ELSE}
122     datetime(3) = 1
123 \textcolor{keywordflow}{ENDIF}
124 
125 \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(hh)) \textcolor{keywordflow}{THEN}
126     datetime(4) = hh
127 \textcolor{keywordflow}{ELSE}
128     datetime(4) = 0
129 \textcolor{keywordflow}{ENDIF}
130 
131 \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(mm)) \textcolor{keywordflow}{THEN}
132     datetime(5) = mm
133 \textcolor{keywordflow}{ELSE}
134     datetime(5) = 0
135 \textcolor{keywordflow}{ENDIF}
136 
137 \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(ss)) \textcolor{keywordflow}{THEN}
138     datetime(6) = ss
139 \textcolor{keywordflow}{ELSE}
140     datetime(6) = 0
141 \textcolor{keywordflow}{ENDIF}
142 
143 \textcolor{comment}{!}
144 \textcolor{comment}{! Check inputs are valid.}
145 \textcolor{comment}{!}
146 \textcolor{keywordflow}{IF} ((datetime(1) .LT. 1970) .OR. (datetime(1) .GT. 2037)) \textcolor{keywordflow}{THEN}
147     print *, \textcolor{stringliteral}{'W: Year is out of range (1970-2037)'}
148     \hyperlink{namespacetime_a7c66adfc707644b0644b33e1557f1486}{date\_time\_to\_unix}   = -1
149     \textcolor{keywordflow}{RETURN}
150 \textcolor{keywordflow}{ENDIF}
151 
152 \textcolor{keywordflow}{IF} ((datetime(2) .LT. 1) .OR. (datetime(2) .GT. 12)) \textcolor{keywordflow}{THEN}
153     print *, \textcolor{stringliteral}{'W: Month is out of range (1-12)'}
154     \hyperlink{namespacetime_a7c66adfc707644b0644b33e1557f1486}{date\_time\_to\_unix}   = -1
155     \textcolor{keywordflow}{RETURN}
156 \textcolor{keywordflow}{ENDIF}
157 
158 \textcolor{keywordflow}{IF} (\hyperlink{namespacetime_ac7f82d40fd2b49e7e9025b103e88555c}{leapyear}(datetime(1))) \textcolor{keywordflow}{THEN}     \textcolor{comment}{! We'll use these results later as well.}
159     mdays(2)    = 29
160 \textcolor{keywordflow}{ELSE}
161     mdays(2)    = 28
162 \textcolor{keywordflow}{ENDIF}
163 \textcolor{keywordflow}{IF} ((datetime(3) .LT. 1) .OR. (datetime(3) .GT. mdays(datetime(2)))) \textcolor{keywordflow}{THEN}
164     print *,\textcolor{stringliteral}{'W: Day is out of range (1-'},mdays(datetime(2)),\textcolor{stringliteral}{')'}
165     \hyperlink{namespacetime_a7c66adfc707644b0644b33e1557f1486}{date\_time\_to\_unix}   = -1
166     \textcolor{keywordflow}{RETURN}
167 \textcolor{keywordflow}{ENDIF}
168 
169 \textcolor{keywordflow}{IF} ((datetime(4) .LT. 0) .OR. (datetime(4) .GT. 23)) \textcolor{keywordflow}{THEN}
170     print *,\textcolor{stringliteral}{'W: Hour is out of range (0-23)'}
171     \hyperlink{namespacetime_a7c66adfc707644b0644b33e1557f1486}{date\_time\_to\_unix}   = -1
172     \textcolor{keywordflow}{RETURN}
173 \textcolor{keywordflow}{ENDIF}
174 
175 \textcolor{keywordflow}{IF} ((datetime(5) .LT. 0) .OR. (datetime(4) .GT. 59)) \textcolor{keywordflow}{THEN}
176     print *,\textcolor{stringliteral}{'W: Minute is out of range (0-59)'}
177     \hyperlink{namespacetime_a7c66adfc707644b0644b33e1557f1486}{date\_time\_to\_unix}   = -1
178     \textcolor{keywordflow}{RETURN}
179 \textcolor{keywordflow}{ENDIF}
180 
181 \textcolor{keywordflow}{IF} ((datetime(6) .LT. 0) .OR. (datetime(6) .GT. 59)) \textcolor{keywordflow}{THEN}
182     print *,\textcolor{stringliteral}{'W: Second is out of range (0-59)'}
183     \hyperlink{namespacetime_a7c66adfc707644b0644b33e1557f1486}{date\_time\_to\_unix}   = -1
184     \textcolor{keywordflow}{RETURN}
185 \textcolor{keywordflow}{ENDIF}
186 
187 \textcolor{comment}{!}
188 \textcolor{comment}{! Now compute the time.}
189 \textcolor{comment}{!}
190 yycnt   = 1970
191 utime   = 0
192 \textcolor{keywordflow}{DO} \textcolor{keywordflow}{WHILE} (yycnt .LT. datetime(1))
193     \textcolor{keywordflow}{IF} (\hyperlink{namespacetime_ac7f82d40fd2b49e7e9025b103e88555c}{leapyear}(yycnt)) \textcolor{keywordflow}{THEN}
194         utime   = utime + 31622400  \textcolor{comment}{! The number of seconds in a leap year.}
195     \textcolor{keywordflow}{ELSE}
196         utime   = utime + 31536000  \textcolor{comment}{! The number of seconds in a normal year (not taking account of leap
       seconds).}
197 \textcolor{keywordflow}{    END IF}
198     yycnt   = yycnt + 1
199 \textcolor{keywordflow}{END DO}
200 
201 mocnt=1
202 \textcolor{keywordflow}{DO} \textcolor{keywordflow}{WHILE} (mocnt .LT. datetime(2))
203     utime   = utime + mdays(mocnt)*86400    \textcolor{comment}{! The number of seconds in the month.}
204     mocnt   = mocnt + 1
205 \textcolor{keywordflow}{END DO}
206 
207 \hyperlink{namespacetime_a7c66adfc707644b0644b33e1557f1486}{date\_time\_to\_unix}   = utime + (datetime(3)-1)*86400 + datetime(4)*3600 + datetime(5)*60 + 
      datetime(6)
208 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{namespacetime_a7c66adfc707644b0644b33e1557f1486_cgraph}
\end{center}
\end{figure}


\index{time@{time}!days\+\_\+to\+\_\+date@{days\+\_\+to\+\_\+date}}
\index{days\+\_\+to\+\_\+date@{days\+\_\+to\+\_\+date}!time@{time}}
\subsubsection[{\texorpdfstring{days\+\_\+to\+\_\+date(\+S\+T\+Y\+E\+A\+R, S\+T\+M\+O\+N\+T\+H, S\+T\+D\+A\+Y, D\+A\+Y\+S, Y\+Y\+Y\+Y, M\+O, D\+D, H\+H, M\+M, S\+S)}{days_to_date(STYEAR, STMONTH, STDAY, DAYS, YYYY, MO, DD, HH, MM, SS)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine time\+::days\+\_\+to\+\_\+date (
\begin{DoxyParamCaption}
\item[{integer (kind=ik4), intent(in)}]{S\+T\+Y\+E\+AR, }
\item[{integer (kind=ik4), intent(in)}]{S\+T\+M\+O\+N\+TH, }
\item[{integer (kind=ik4), intent(in)}]{S\+T\+D\+AY, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{D\+A\+YS, }
\item[{integer (kind=ik4), dimension(\+:), intent(out), optional}]{Y\+Y\+YY, }
\item[{integer (kind=ik4), dimension(\+:), intent(out), optional}]{MO, }
\item[{integer (kind=ik4), dimension(\+:), intent(out), optional}]{DD, }
\item[{integer (kind=ik4), dimension(\+:), intent(out), optional}]{HH, }
\item[{integer (kind=ik4), dimension(\+:), intent(out), optional}]{MM, }
\item[{integer (kind=ik4), dimension(\+:), intent(out), optional}]{SS}
\end{DoxyParamCaption}
)}\hypertarget{namespacetime_a29670e6cf798cee7d9e33201b38f9507}{}\label{namespacetime_a29670e6cf798cee7d9e33201b38f9507}


Definition at line 14 of file time.\+f90.


\begin{DoxyCode}
14 
15 \textcolor{keywordtype}{IMPLICIT NONE}
16 
17 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}                          :: styear       \textcolor{comment}{! The year which the day count is
       relative to.}
18 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}                          :: stmonth      \textcolor{comment}{! The month which the day count is
       relative to.}
19 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}                          :: stday        \textcolor{comment}{! The day which the day count is
       relative to.}
20 \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}               :: days         \textcolor{comment}{! The time in days relative to
       STYEAR-STMONTH-STDAYT00:00:00}
21 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{OPTIONAL} :: yyyy         \textcolor{comment}{! The year.}
22 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{OPTIONAL} :: mo           \textcolor{comment}{! The month.}
23 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{OPTIONAL} :: dd           \textcolor{comment}{! The day.}
24 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{OPTIONAL} :: hh           \textcolor{comment}{! The hour.}
25 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{OPTIONAL} :: mm           \textcolor{comment}{! The minute.}
26 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{OPTIONAL} :: ss           \textcolor{comment}{! The second.}
27 
28 \textcolor{keywordtype}{INTEGER (KIND=IK4)}                                      :: nt           \textcolor{comment}{! Number of times in the time
       arrays.}
29 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(12)}                       :: mdays    = (/31, 28, 31, 30, 31, 30, 31, 31, 30,
       31, 30, 31/)
30 \textcolor{keywordtype}{INTEGER (KIND=IK4)}                                      :: ii           \textcolor{comment}{! Counter.}
31 \textcolor{keywordtype}{REAL (KIND=RK8)}                                         :: tdn
32 \textcolor{keywordtype}{INTEGER (KIND=IK4)}                                      :: tyy, tmo, tdd, thh, tmm, tss, tti
33 
34 nt  = \textcolor{keyword}{SIZE}(days)
35 
36 \textcolor{keywordflow}{DO} ii=1,nt
37     tyy = styear
38     \textcolor{comment}{!}
39     \textcolor{comment}{! We do a bit of rounding stuff here, based on what outputs the user wants.}
40     \textcolor{comment}{!}
41     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(ss)) \textcolor{keywordflow}{THEN}
42         tdn = int((days(ii)+(stday))*86400 + 0.5)/86400.      \textcolor{comment}{! Round to the nearest second.}
43     \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(mm)) \textcolor{keywordflow}{THEN}
44         tdn = int((days(ii)+(stday))*1440 + 0.5)/1440.        \textcolor{comment}{! Round to the nearest minute.}
45     \textcolor{keywordflow}{ELSE}
46         tdn = int((days(ii)+(stday))*24 + 0.5)/24.            \textcolor{comment}{! Round to the nearest hour.}
47 \textcolor{keywordflow}{    END IF}
48 
49     \textcolor{comment}{!}
50     \textcolor{comment}{! First calculate the date}
51     \textcolor{comment}{!}
52     tmo = stmonth
53     \textcolor{keywordflow}{DO} \textcolor{keywordflow}{WHILE} (tdn .GE. (mdays(tmo)+1))
54         \textcolor{keywordflow}{IF} (\hyperlink{namespacetime_ac7f82d40fd2b49e7e9025b103e88555c}{leapyear}(tyy)) \textcolor{keywordflow}{THEN}
55             mdays(2) = 29
56         \textcolor{keywordflow}{ELSE}
57             mdays(2) = 28
58 \textcolor{keywordflow}{        END IF}
59         \textcolor{keywordflow}{DO} \textcolor{keywordflow}{WHILE} ((tdn .GE. (mdays(tmo)+1)))
60             tdn = tdn - mdays(tmo)
61             tmo = tmo + 1
62             \textcolor{keywordflow}{if} (tmo > 12) \textcolor{keywordflow}{exit}
63 \textcolor{keywordflow}{        END DO}
64         \textcolor{keywordflow}{if} (tmo > 12) \textcolor{keywordflow}{then}
65             tyy = tyy + 1
66             tmo = 1
67 \textcolor{keywordflow}{       endif}
68 \textcolor{keywordflow}{    END DO}
69     tdd = int(tdn, kind=\hyperlink{namespaceportable_aa110cf333432508140602ea192c4b2ea}{ik4})
70     \textcolor{comment}{!}
71     \textcolor{comment}{! Now calculate the time, to the nearest second.}
72     \textcolor{comment}{!}
73     tti = int((tdn - tdd)*86400. + 0.5, kind=\hyperlink{namespaceportable_aa110cf333432508140602ea192c4b2ea}{ik4})     \textcolor{comment}{! Round to the nearest second.}
74     thh = tti/3600
75     tmm = (tti - thh*3600)/60
76     tss = tti - thh*3600 - tmm*60
77 
78     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(yyyy))  yyyy(ii)    = tyy
79     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(mo))    mo(ii)      = tmo
80     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(dd))    dd(ii)      = tdd
81     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(hh))    hh(ii)      = thh
82     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(mm))    mm(ii)      = tmm
83     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(ss))    ss(ii)      = tss
84 \textcolor{keywordflow}{END DO}
85     
86 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=294pt]{namespacetime_a29670e6cf798cee7d9e33201b38f9507_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{namespacetime_a29670e6cf798cee7d9e33201b38f9507_icgraph}
\end{center}
\end{figure}


\index{time@{time}!leapyear@{leapyear}}
\index{leapyear@{leapyear}!time@{time}}
\subsubsection[{\texorpdfstring{leapyear(\+Y\+E\+A\+R)}{leapyear(YEAR)}}]{\setlength{\rightskip}{0pt plus 5cm}logical function time\+::leapyear (
\begin{DoxyParamCaption}
\item[{integer (kind=ik4), intent(in)}]{Y\+E\+AR}
\end{DoxyParamCaption}
)}\hypertarget{namespacetime_ac7f82d40fd2b49e7e9025b103e88555c}{}\label{namespacetime_ac7f82d40fd2b49e7e9025b103e88555c}


Definition at line 220 of file time.\+f90.


\begin{DoxyCode}
220 
221 \textcolor{keywordtype}{IMPLICIT NONE}
222 \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}                          :: year         \textcolor{comment}{! The year being tested.}
223 
224 \textcolor{keywordflow}{IF} (mod(year,4) .EQ. 0) \textcolor{keywordflow}{THEN}
225     \textcolor{keywordflow}{IF} ((mod(year,100) .EQ. 0) .AND. (mod(year,400) .NE. 0)) \textcolor{keywordflow}{THEN}
226         \hyperlink{namespacetime_ac7f82d40fd2b49e7e9025b103e88555c}{leapyear}    = .false.
227     \textcolor{keywordflow}{ELSE}
228         \hyperlink{namespacetime_ac7f82d40fd2b49e7e9025b103e88555c}{leapyear}    = .true.
229 \textcolor{keywordflow}{    END IF}
230 \textcolor{keywordflow}{ELSE}
231     \hyperlink{namespacetime_ac7f82d40fd2b49e7e9025b103e88555c}{leapyear}        = .false.
232 \textcolor{keywordflow}{END IF}
233 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacetime_ac7f82d40fd2b49e7e9025b103e88555c_icgraph}
\end{center}
\end{figure}


