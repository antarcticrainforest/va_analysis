\hypertarget{namespaceio}{}\section{io Module Reference}
\label{namespaceio}\index{io@{io}}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespaceio_abed61f2af0a37265b7a1d15300f61996}{ipt\+\_\+vht} (I\+N\+P\+U\+T\+F\+I\+LE, I\+N\+S\+T\+R\+U\+M\+E\+NT, NV, NP, N\+ST, NT, V, P, ST, T, D)
\item 
subroutine \hyperlink{namespaceio_ae478b0148dea487c688bfea00e08cade}{ipt\+\_\+ht} (I\+N\+P\+U\+T\+F\+I\+LE, I\+N\+S\+T\+R\+U\+M\+E\+NT, NV, N\+ST, NT, V, ST, L\+ON, L\+AT, T, D)
\item 
subroutine \hyperlink{namespaceio_a1feb605e982e6696d29a63e635b8d3e1}{opt\+\_\+vht\+\_\+netcdf} (O\+U\+T\+P\+U\+T\+F\+I\+LE, I\+N\+S\+T\+R\+U\+M\+E\+NT, NV, NP, N\+ST, NT, V, P, ST, T, D)
\item 
subroutine \hyperlink{namespaceio_a63d1618c60598d1e5ac65348efb74bdc}{opt\+\_\+3d\+\_\+netcdf} (O\+U\+T\+P\+U\+T\+F\+I\+LE, DU, VU, DS, P, T, S\+TN, W\+E\+I\+G\+HT, B\+O\+U\+N\+D\+A\+RY, S\+T\+RU, S\+T\+RS)
\item 
subroutine \hyperlink{namespaceio_a0f9f8edb9a7173638e450ce3c4db7844}{ipt\+\_\+3d\+\_\+netcdf} (I\+N\+P\+U\+T\+F\+I\+LE, DU, VU, DS, T, S\+TN, W\+E\+I\+G\+HT, L\+EV, B\+O\+U\+N\+D\+A\+RY, S\+T\+RU, S\+T\+RS)
\item 
subroutine \hyperlink{namespaceio_ab1a423779bddf2d4557f39dd81431d93}{opt\+\_\+budget\+\_\+netcdf} (O\+U\+T\+P\+U\+T\+F\+I\+LE, B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+MN, B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+ER, V\+B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+MN, V\+B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+ER, A\+V\+E\+\_\+\+QS, A\+V\+E\+\_\+\+SS, P, T)
\item 
subroutine \hyperlink{namespaceio_aba707a842ac0a3e2e9def20af0b36c32}{ipt\+\_\+budget\+\_\+netcdf} (I\+N\+P\+U\+T\+F\+I\+LE, B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+MN, B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+ER, V\+B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+MN, V\+B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+ER, A\+V\+E\+\_\+\+QS, A\+V\+E\+\_\+\+SS, P, T)
\item 
subroutine \hyperlink{namespaceio_ab6bcb3dc7b4a08b242b7fbd4e11ed319}{opt\+\_\+2d\+\_\+netcdf} (O\+U\+T\+P\+U\+T\+F\+I\+LE, T, B\+A\+R\+\_\+\+P\+R\+ES, A\+D\+PS, P\+R\+E\+C\+IP, L\+P\+R\+E\+C\+IP, E\+V\+A\+P\+OR, S\+HF, RL, R\+A\+D\+I\+A\+T\+I\+O\+NT, R\+A\+D\+I\+A\+T\+I\+O\+NB, R\+A\+D\+I\+A\+T\+I\+ON, T\+A\+OX, T\+A\+OY)
\item 
subroutine \hyperlink{namespaceio_aff87bbb9c43d6db1fedd086586aab0c6}{ipt\+\_\+2d\+\_\+netcdf} (I\+N\+P\+U\+T\+F\+I\+LE, T, B\+A\+R\+\_\+\+P\+R\+ES, A\+D\+PS, P\+R\+E\+C\+IP, L\+P\+R\+E\+C\+IP, E\+V\+A\+P\+OR, S\+HF, RL, R\+A\+D\+I\+A\+T\+I\+O\+NT, R\+A\+D\+I\+A\+T\+I\+O\+NB, R\+A\+D\+I\+A\+T\+I\+ON, T\+A\+OX, T\+A\+OY)
\item 
subroutine \hyperlink{namespaceio_ac91ebbbf1426451d33f3e32b08f70aee}{ipt\+\_\+2draw\+\_\+netcdf} (I\+N\+P\+U\+T\+F\+I\+LE, V\+A\+R\+\_\+\+N\+A\+ME, V\+AR)
\item 
subroutine \hyperlink{namespaceio_a50ab1073758d8d341087a0755354011d}{opt\+\_\+forcing\+\_\+netcdf} (O\+U\+T\+P\+U\+T\+F\+I\+LE, S\+F\+C\+\_\+\+D\+A\+TA, M\+L\+\_\+\+D\+A\+TA, C\+F\+\_\+\+L\+ON, C\+F\+\_\+\+L\+AT, C\+F\+\_\+\+P\+H\+IS, P\+L\+E\+VS)
\end{DoxyCompactItemize}


\subsection{Function/\+Subroutine Documentation}
\index{io@{io}!ipt\+\_\+2d\+\_\+netcdf@{ipt\+\_\+2d\+\_\+netcdf}}
\index{ipt\+\_\+2d\+\_\+netcdf@{ipt\+\_\+2d\+\_\+netcdf}!io@{io}}
\subsubsection[{\texorpdfstring{ipt\+\_\+2d\+\_\+netcdf(\+I\+N\+P\+U\+T\+F\+I\+L\+E, T, B\+A\+R\+\_\+\+P\+R\+E\+S, A\+D\+P\+S, P\+R\+E\+C\+I\+P, L\+P\+R\+E\+C\+I\+P, E\+V\+A\+P\+O\+R, S\+H\+F, R\+L, R\+A\+D\+I\+A\+T\+I\+O\+N\+T, R\+A\+D\+I\+A\+T\+I\+O\+N\+B, R\+A\+D\+I\+A\+T\+I\+O\+N, T\+A\+O\+X, T\+A\+O\+Y)}{ipt_2d_netcdf(INPUTFILE, T, BAR_PRES, ADPS, PRECIP, LPRECIP, EVAPOR, SHF, RL, RADIATIONT, RADIATIONB, RADIATION, TAOX, TAOY)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::ipt\+\_\+2d\+\_\+netcdf (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{I\+N\+P\+U\+T\+F\+I\+LE, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{T, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{B\+A\+R\+\_\+\+P\+R\+ES, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{A\+D\+PS, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{P\+R\+E\+C\+IP, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{L\+P\+R\+E\+C\+IP, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{E\+V\+A\+P\+OR, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{S\+HF, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{RL, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{R\+A\+D\+I\+A\+T\+I\+O\+NT, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{R\+A\+D\+I\+A\+T\+I\+O\+NB, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{R\+A\+D\+I\+A\+T\+I\+ON, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{T\+A\+OX, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{T\+A\+OY}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_aff87bbb9c43d6db1fedd086586aab0c6}{}\label{namespaceio_aff87bbb9c43d6db1fedd086586aab0c6}


Definition at line 1462 of file io.\+f90.


\begin{DoxyCode}
1462     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
1463     \textcolor{keywordtype}{USE }netcdf
1464 
1465     \textcolor{keywordtype}{IMPLICIT NONE}
1466 
1467     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: inputfile    \textcolor{comment}{! Name of the input
       file.}
1468     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: t            \textcolor{comment}{! Time.}
1469     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: bar\_pres     \textcolor{comment}{! Barometric
       pressure (hPa).}
1470     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: adps         \textcolor{comment}{! V.grad(PS)}
1471     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: precip
1472     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: lprecip
1473     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: evapor
1474     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: shf
1475     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: rl
1476     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: radiationt
1477     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: radiationb
1478     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: radiation
1479     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: taox
1480     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: taoy
1481 
1482     \textcolor{comment}{!}
1483     \textcolor{comment}{! Local variables.}
1484     \textcolor{comment}{!}
1485     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ncid                                                 \textcolor{comment}{! ID of NetCDF
       file.}
1486     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: t\_dim\_id                                             \textcolor{comment}{! Time dimension
       ID.}
1487     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: t\_dim\_len                                            \textcolor{comment}{! Length of the
       time dimension.}
1488     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: t\_var\_id                                             \textcolor{comment}{! Time coordinate
       variable.}
1489     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: bar\_pres\_var\_id
1490     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: adps\_var\_id
1491     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: precip\_var\_id
1492     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: lprecip\_var\_id
1493     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: evapor\_var\_id
1494     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: shf\_var\_id
1495     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: rl\_var\_id
1496     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: radiationt\_var\_id
1497     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: radiationb\_var\_id
1498     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: radiation\_var\_id
1499     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: taox\_var\_id
1500     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: taoy\_var\_id
1501     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: memst                                                \textcolor{comment}{! Status of memory
       allocations.}
1502     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: iost                                                 \textcolor{comment}{! I/O status.}
1503     \textcolor{keywordtype}{LOGICAL}                     :: ncerror                                              \textcolor{comment}{! Did a NetCDF
       function fail?}
1504 
1505     iost    = nf90\_noerr
1506     ncerror = .false.
1507     \textcolor{comment}{!}
1508     \textcolor{comment}{! Open the NetCDF file.}
1509     \textcolor{comment}{!}
1510     iost    = nf90\_open(inputfile, nf90\_nowrite, ncid)
1511     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1512 
1513     \textcolor{comment}{!}
1514     \textcolor{comment}{! Get the time dimension ID, and the length of the dimension.}
1515     \textcolor{comment}{!}
1516     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"time"}, t\_dim\_id)                            \textcolor{comment}{! Time steps.}
1517     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1518     iost    = nf90\_inquire\_dimension(ncid, t\_dim\_id, len=t\_dim\_len)             \textcolor{comment}{! Get the time dimension
       length.}
1519     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1520 
1521     \textcolor{comment}{!}
1522     \textcolor{comment}{! Allocate enough memory to hold all the data. Be paranoid ... check that arrays have not already been
       allocated.}
1523     \textcolor{comment}{!}
1524     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(t))           \textcolor{keyword}{DEALLOCATE}(t)
1525     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(bar\_pres))    \textcolor{keyword}{DEALLOCATE}(bar\_pres)
1526     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(adps))        \textcolor{keyword}{DEALLOCATE}(adps)
1527     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(precip))      \textcolor{keyword}{DEALLOCATE}(precip)
1528     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(lprecip))     \textcolor{keyword}{DEALLOCATE}(lprecip)
1529     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(evapor))      \textcolor{keyword}{DEALLOCATE}(evapor)
1530     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(shf))         \textcolor{keyword}{DEALLOCATE}(shf)
1531     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(rl))          \textcolor{keyword}{DEALLOCATE}(rl)
1532     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(radiationt))  \textcolor{keyword}{DEALLOCATE}(radiationt)
1533     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(radiationb))  \textcolor{keyword}{DEALLOCATE}(radiationb)
1534     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(radiation))   \textcolor{keyword}{DEALLOCATE}(radiation)
1535     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(taox))        \textcolor{keyword}{DEALLOCATE}(taox)
1536     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(taoy))        \textcolor{keyword}{DEALLOCATE}(taoy)
1537     \textcolor{keyword}{ALLOCATE}(t(t\_dim\_len), bar\_pres(t\_dim\_len), adps(t\_dim\_len), precip(t\_dim\_len), lprecip(t\_dim\_len), 
      evapor(t\_dim\_len), &
1538         & shf(t\_dim\_len), rl(t\_dim\_len), radiationt(t\_dim\_len), radiationb(t\_dim\_len), radiation(t\_dim\_len)
      , taox(t\_dim\_len), &
1539         & taoy(t\_dim\_len), stat=memst)
1540     \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
1541         print *,\textcolor{stringliteral}{'E: Unable to allocate memory to hold 2D data'}
1542         stop \textcolor{stringliteral}{'1'}
1543 \textcolor{keywordflow}{    END IF}
1544 
1545     \textcolor{comment}{!}
1546     \textcolor{comment}{! Get the variable IDs.}
1547     \textcolor{comment}{!}
1548     ncerror = .false.
1549     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"time"}, t\_var\_id)                   .NE. nf90\_noerr) .OR. ncerror
1550     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"bar\_pres"}, bar\_pres\_var\_id)        .NE. nf90\_noerr) .OR. ncerror
1551     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"adps"}, adps\_var\_id)                .NE. nf90\_noerr) .OR. ncerror
1552     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"precip"}, precip\_var\_id)            .NE. nf90\_noerr) .OR. ncerror
1553     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"lprecip"}, lprecip\_var\_id)          .NE. nf90\_noerr) .OR. ncerror
1554     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"evapor"}, evapor\_var\_id)            .NE. nf90\_noerr) .OR. ncerror
1555     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"shf"}, shf\_var\_id)                  .NE. nf90\_noerr) .OR. ncerror
1556     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"rl"}, rl\_var\_id)                    .NE. nf90\_noerr) .OR. ncerror
1557     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"radiationt"}, radiationt\_var\_id)    .NE. nf90\_noerr) .OR. ncerror
1558     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"radiationb"}, radiationb\_var\_id)    .NE. nf90\_noerr) .OR. ncerror
1559     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"radiation"}, radiation\_var\_id)      .NE. nf90\_noerr) .OR. ncerror
1560     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"taox"}, taox\_var\_id)                .NE. nf90\_noerr) .OR. ncerror
1561     ncerror = (nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"taoy"}, taoy\_var\_id)                .NE. nf90\_noerr) .OR. ncerror
1562     \textcolor{keywordflow}{IF} (ncerror) \textcolor{keywordflow}{GO TO} 9999
1563 
1564     \textcolor{comment}{!}
1565     \textcolor{comment}{! Read the data.}
1566     \textcolor{comment}{!}
1567     ncerror = .false.
1568     ncerror = (nf90\_get\_var(ncid, t\_var\_id, t)                          .NE. nf90\_noerr)
1569     ncerror = (nf90\_get\_var(ncid, bar\_pres\_var\_id, bar\_pres)            .NE. nf90\_noerr) .OR. ncerror
1570     ncerror = (nf90\_get\_var(ncid, adps\_var\_id, adps)                    .NE. nf90\_noerr) .OR. ncerror
1571     ncerror = (nf90\_get\_var(ncid, precip\_var\_id, precip)                .NE. nf90\_noerr) .OR. ncerror
1572     ncerror = (nf90\_get\_var(ncid, lprecip\_var\_id, lprecip)              .NE. nf90\_noerr) .OR. ncerror
1573     ncerror = (nf90\_get\_var(ncid, evapor\_var\_id, evapor)                .NE. nf90\_noerr) .OR. ncerror
1574     ncerror = (nf90\_get\_var(ncid, shf\_var\_id, shf)                      .NE. nf90\_noerr) .OR. ncerror
1575     ncerror = (nf90\_get\_var(ncid, rl\_var\_id, rl)                        .NE. nf90\_noerr) .OR. ncerror
1576     ncerror = (nf90\_get\_var(ncid, radiationt\_var\_id, radiationt)        .NE. nf90\_noerr) .OR. ncerror
1577     ncerror = (nf90\_get\_var(ncid, radiationb\_var\_id, radiationb)        .NE. nf90\_noerr) .OR. ncerror
1578     ncerror = (nf90\_get\_var(ncid, radiation\_var\_id, radiation)          .NE. nf90\_noerr) .OR. ncerror
1579     ncerror = (nf90\_get\_var(ncid, taox\_var\_id, taox)                    .NE. nf90\_noerr) .OR. ncerror
1580     ncerror = (nf90\_get\_var(ncid, taoy\_var\_id, taoy)                    .NE. nf90\_noerr) .OR. ncerror
1581     \textcolor{keywordflow}{IF} (ncerror) \textcolor{keywordflow}{GO TO} 9999
1582 
1583     \textcolor{comment}{!}
1584     \textcolor{comment}{! Close the NetCDF file.}
1585     \textcolor{comment}{!}
1586     iost    = nf90\_close(ncid)
1587     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1588 
1589     \textcolor{comment}{!}
1590     \textcolor{comment}{! Catch any NetCDF errors here.}
1591     \textcolor{comment}{!}
1592     9999 \textcolor{keywordflow}{CONTINUE}
1593     \textcolor{keywordflow}{IF} (ncerror) \textcolor{keywordflow}{THEN}
1594         print *,\textcolor{stringliteral}{'E: NetCDF error encountered'}
1595         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
1596             print *, trim(nf90\_strerror(iost))
1597 \textcolor{keywordflow}{        END IF}
1598         stop \textcolor{stringliteral}{'1'}
1599 \textcolor{keywordflow}{    END IF}
1600 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=270pt]{namespaceio_aff87bbb9c43d6db1fedd086586aab0c6_icgraph}
\end{center}
\end{figure}


\index{io@{io}!ipt\+\_\+2draw\+\_\+netcdf@{ipt\+\_\+2draw\+\_\+netcdf}}
\index{ipt\+\_\+2draw\+\_\+netcdf@{ipt\+\_\+2draw\+\_\+netcdf}!io@{io}}
\subsubsection[{\texorpdfstring{ipt\+\_\+2draw\+\_\+netcdf(\+I\+N\+P\+U\+T\+F\+I\+L\+E, V\+A\+R\+\_\+\+N\+A\+M\+E, V\+A\+R)}{ipt_2draw_netcdf(INPUTFILE, VAR_NAME, VAR)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::ipt\+\_\+2draw\+\_\+netcdf (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{I\+N\+P\+U\+T\+F\+I\+LE, }
\item[{character (len=$\ast$), intent(in)}]{V\+A\+R\+\_\+\+N\+A\+ME, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{V\+AR}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_ac91ebbbf1426451d33f3e32b08f70aee}{}\label{namespaceio_ac91ebbbf1426451d33f3e32b08f70aee}


Definition at line 1614 of file io.\+f90.


\begin{DoxyCode}
1614     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
1615     \textcolor{keywordtype}{USE }netcdf
1616 
1617     \textcolor{keywordtype}{IMPLICIT NONE}
1618 
1619     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: inputfile    \textcolor{comment}{! Name of the input
       file.}
1620     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: var\_name     \textcolor{comment}{! Name of the
       variable to read.}
1621     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}             :: var          \textcolor{comment}{! Holds the data we
       are reading.}
1622 
1623 
1624     \textcolor{comment}{!}
1625     \textcolor{comment}{! Local variables.}
1626     \textcolor{comment}{!}
1627     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ncid                                                 \textcolor{comment}{! ID of NetCDF
       file.}
1628     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: t\_dim\_id                                             \textcolor{comment}{! Time dimension
       ID.}
1629     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: t\_dim\_len                                            \textcolor{comment}{! Length of the
       time dimension.}
1630     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: var\_id                                               \textcolor{comment}{! Variable ID.}
1631     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: memst                                                \textcolor{comment}{! Status of memory
       allocations.}
1632     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: iost                                                 \textcolor{comment}{! I/O status.}
1633 
1634     \textcolor{comment}{!}
1635     \textcolor{comment}{! Open the NetCDF file.}
1636     \textcolor{comment}{!}
1637     iost    = nf90\_open(inputfile, nf90\_nowrite, ncid)
1638     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
1639         print *,\textcolor{stringliteral}{'E: '},nf90\_strerror(iost)
1640         \textcolor{keywordflow}{GO TO} 9999
1641 \textcolor{keywordflow}{    END IF}
1642 
1643     \textcolor{comment}{!}
1644     \textcolor{comment}{! Get the time dimension ID, and the length of the dimension.}
1645     \textcolor{comment}{!}
1646     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"time"}, t\_dim\_id)                            \textcolor{comment}{! Time steps.}
1647     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
1648         print *,\textcolor{stringliteral}{'E: '},nf90\_strerror(iost)
1649         \textcolor{keywordflow}{GO TO} 9999
1650 \textcolor{keywordflow}{    END IF}
1651     iost    = nf90\_inquire\_dimension(ncid, t\_dim\_id, len=t\_dim\_len)             \textcolor{comment}{! Get the time dimension
       length.}
1652     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
1653         print *,\textcolor{stringliteral}{'E: '},nf90\_strerror(iost)
1654         \textcolor{keywordflow}{GO TO} 9999
1655 \textcolor{keywordflow}{    END IF}
1656 
1657     \textcolor{comment}{!}
1658     \textcolor{comment}{! Allocate enough memory to hold all the data. Be paranoid ... check that arrays have not already been
       allocated.}
1659     \textcolor{comment}{!}
1660     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(var))           \textcolor{keyword}{DEALLOCATE}(var)
1661     \textcolor{keyword}{ALLOCATE}(var(t\_dim\_len), stat=memst)
1662     \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
1663         print *,\textcolor{stringliteral}{'E: Unable to allocate memory to hold data'}
1664         \textcolor{keywordflow}{GO TO} 9999
1665 \textcolor{keywordflow}{    END IF}
1666 
1667     \textcolor{comment}{!}
1668     \textcolor{comment}{! Get the variable IDs.}
1669     \textcolor{comment}{!}
1670     iost = nf90\_inq\_varid(ncid, var\_name, var\_id)
1671     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
1672         print *,\textcolor{stringliteral}{'E: '},nf90\_strerror(iost)
1673         \textcolor{keywordflow}{GO TO} 9999
1674 \textcolor{keywordflow}{    END IF}
1675 
1676     \textcolor{comment}{!}
1677     \textcolor{comment}{! Read the data.}
1678     \textcolor{comment}{!}
1679     iost = nf90\_get\_var(ncid, var\_id, var)
1680     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
1681         print *,\textcolor{stringliteral}{'E: '},nf90\_strerror(iost)
1682         \textcolor{keywordflow}{GO TO} 9999
1683 \textcolor{keywordflow}{    END IF}
1684 
1685     \textcolor{comment}{!}
1686     \textcolor{comment}{! Close the NetCDF file.}
1687     \textcolor{comment}{!}
1688     iost    = nf90\_close(ncid)
1689     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
1690         print *,\textcolor{stringliteral}{'E: '},nf90\_strerror(iost)
1691         \textcolor{keywordflow}{GO TO} 9999
1692 \textcolor{keywordflow}{    END IF}
1693 
1694     9999 \textcolor{keywordflow}{CONTINUE}       \textcolor{comment}{! Errors will be sent here.}
1695 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=319pt]{namespaceio_ac91ebbbf1426451d33f3e32b08f70aee_icgraph}
\end{center}
\end{figure}


\index{io@{io}!ipt\+\_\+3d\+\_\+netcdf@{ipt\+\_\+3d\+\_\+netcdf}}
\index{ipt\+\_\+3d\+\_\+netcdf@{ipt\+\_\+3d\+\_\+netcdf}!io@{io}}
\subsubsection[{\texorpdfstring{ipt\+\_\+3d\+\_\+netcdf(\+I\+N\+P\+U\+T\+F\+I\+L\+E, D\+U, V\+U, D\+S, T, S\+T\+N, W\+E\+I\+G\+H\+T, L\+E\+V, B\+O\+U\+N\+D\+A\+R\+Y, S\+T\+R\+U, S\+T\+R\+S)}{ipt_3d_netcdf(INPUTFILE, DU, VU, DS, T, STN, WEIGHT, LEV, BOUNDARY, STRU, STRS)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::ipt\+\_\+3d\+\_\+netcdf (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{I\+N\+P\+U\+T\+F\+I\+LE, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:,\+:), intent(out), optional, allocatable}]{DU, }
\item[{character (len=64), dimension(\+:), intent(out), optional, allocatable}]{VU, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:), intent(out), optional, allocatable}]{DS, }
\item[{real (kind=rk8), dimension(\+:), intent(out), optional, allocatable}]{T, }
\item[{character (len=64), dimension(\+:), intent(out), optional, allocatable}]{S\+TN, }
\item[{real (kind=rk8), dimension(\+:), intent(out), optional, allocatable}]{W\+E\+I\+G\+HT, }
\item[{real (kind=rk8), dimension(\+:), intent(out), optional, allocatable}]{L\+EV, }
\item[{integer (kind=ik4), dimension(\+:,\+:), intent(out), optional, allocatable}]{B\+O\+U\+N\+D\+A\+RY, }
\item[{integer (kind=ik4), dimension(\+:), intent(out), optional, allocatable}]{S\+T\+RU, }
\item[{integer (kind=ik4), dimension(\+:), intent(out), optional, allocatable}]{S\+T\+RS}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_a0f9f8edb9a7173638e450ce3c4db7844}{}\label{namespaceio_a0f9f8edb9a7173638e450ce3c4db7844}


Definition at line 618 of file io.\+f90.


\begin{DoxyCode}
618     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
619     \textcolor{keywordtype}{USE }netcdf
620 
621     \textcolor{keywordtype}{IMPLICIT NONE}
622 
623     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                           :: inputfile    \textcolor{comment}{! Name of the
       input file.}
624     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:,:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL} :: du           \textcolor{comment}{! The 3D data.}
625     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}    :: vu           \textcolor{comment}{! Names of the
       variables in DU.}
626     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}   :: ds           \textcolor{comment}{! Surface level
       data.}
627     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}       :: t            \textcolor{comment}{! Time steps.  
              }
628     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}    :: stn          \textcolor{comment}{! Names of the
       stations.}
629     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}       :: lev          \textcolor{comment}{! Vertical
       levels in analysis.}
630     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}  :: boundary     \textcolor{comment}{! Boundary
       array.}
631     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}    :: stru         \textcolor{comment}{! STRU array.}
632     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}    :: strs         \textcolor{comment}{! STRS array.}
633     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}       :: weight       \textcolor{comment}{! WEIGHT array.}
634 
635     \textcolor{comment}{!}
636     \textcolor{comment}{! Local variables.}
637     \textcolor{comment}{!}
638     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ncid                                                 \textcolor{comment}{! ID of NetCDF
       file.}
639 
640     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: t\_dim\_id                                             \textcolor{comment}{! Time dimension
       ID.}
641     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: t\_dim\_len                                            \textcolor{comment}{! Number of time
       steps.}
642     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: stn\_dim\_id                                           \textcolor{comment}{! Station dimension
       ID.}
643     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: stn\_dim\_len                                          \textcolor{comment}{! Number of
       stations.}
644     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: lev\_dim\_id                                           \textcolor{comment}{! Vertical level
       dimension ID.}
645     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: lev\_dim\_len                                          \textcolor{comment}{! Number of
       vertical levels.}
646     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: var\_dim\_id                                           \textcolor{comment}{! Variable
       dimension ID.}
647     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: var\_dim\_len                                          \textcolor{comment}{! Number of
       variables.}
648     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: str\_dim\_id                                           \textcolor{comment}{! String dimension
       ID.}
649     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: str\_dim\_len                                          \textcolor{comment}{! String length.}
650     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: bnd\_dim\_id                                           \textcolor{comment}{! Dimension used
       for BOUNDARY array.}
651     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: bnd\_dim\_len                                          \textcolor{comment}{! Length of BND
       dimension.}
652     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: stru\_dim\_id                                          \textcolor{comment}{! Dimension used
       for STRU array.}
653     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: stru\_dim\_len                                         \textcolor{comment}{! Length of STRU
       dimension.}
654     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: strs\_dim\_id                                          \textcolor{comment}{! Dimension used
       for STRS array.}
655     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: strs\_dim\_len                                         \textcolor{comment}{! Length of STRS
       dimension.}
656     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: weight\_dim\_id                                        \textcolor{comment}{! Dimension used
       for WEIGHT array.}
657     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: weight\_dim\_len                                       \textcolor{comment}{! Length of WEIGHT
       dimension.}
658 
659     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: t\_var\_id                                             \textcolor{comment}{! Time variable ID.}
660     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: du\_var\_id                                            \textcolor{comment}{! 3D data variable
       ID.}
661     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ds\_var\_id                                            \textcolor{comment}{! Surface data
       variable ID.}
662     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: stn\_var\_id                                           \textcolor{comment}{! Station names
       variable ID.}
663     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: lev\_var\_id                                           \textcolor{comment}{! Vertical levels
       variable ID.}
664     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: vu\_var\_id                                            \textcolor{comment}{! Variable names
       variable ID.}
665     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: boundary\_var\_id                                      \textcolor{comment}{! ID of BOUNDARY
       variable.}
666     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: stru\_var\_id                                          \textcolor{comment}{! ID of STRU
       variable.}
667     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: strs\_var\_id                                          \textcolor{comment}{! ID of STRS
       variable.}
668     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: weight\_var\_id                                        \textcolor{comment}{! ID of WEIGHT
       variable.}
669 
670     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: memst                                                \textcolor{comment}{! Status of memory
       allocations.}
671     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: iost                                                 \textcolor{comment}{! I/O status.}
672     \textcolor{keywordtype}{LOGICAL}                     :: ncerror
673 
674     iost    = nf90\_noerr
675     ncerror = .false.
676     \textcolor{comment}{!}
677     \textcolor{comment}{! Open the NetCDF file.}
678     \textcolor{comment}{!}
679     iost    = nf90\_open(inputfile, nf90\_nowrite, ncid)
680     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
681 
682     \textcolor{comment}{!}
683     \textcolor{comment}{! Get the dimension IDs, and the length of the dimensions.}
684     \textcolor{comment}{!}
685     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"time"}, t\_dim\_id)                            \textcolor{comment}{! Time steps.}
686     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
687     iost    = nf90\_inquire\_dimension(ncid, t\_dim\_id, len=t\_dim\_len)             \textcolor{comment}{! Get the number of time
       steps.}
688     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
689 
690     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"stations"}, stn\_dim\_id)                      \textcolor{comment}{! Time steps.}
691     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
692     iost    = nf90\_inquire\_dimension(ncid, stn\_dim\_id, len=stn\_dim\_len)         \textcolor{comment}{! Get the number of
       stations.}
693     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
694 
695     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"levels"}, lev\_dim\_id)                        \textcolor{comment}{! Vertical levels.}
696     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
697     iost    = nf90\_inquire\_dimension(ncid, lev\_dim\_id, len=lev\_dim\_len)         \textcolor{comment}{! Number of vertical
       levels.}
698     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
699 
700     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"variables"}, var\_dim\_id)                     \textcolor{comment}{! Variables.}
701     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
702     iost    = nf90\_inquire\_dimension(ncid, var\_dim\_id, len=var\_dim\_len)         \textcolor{comment}{! Get the number of
       variables.}
703     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
704 
705     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"string"}, str\_dim\_id)                        \textcolor{comment}{! String dimension.}
706     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
707     iost    = nf90\_inquire\_dimension(ncid, str\_dim\_id, len=str\_dim\_len)         \textcolor{comment}{! String length.}
708     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
709 
710     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"bnd"}, bnd\_dim\_id)                           \textcolor{comment}{! bnd dimension.}
711     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
712     iost    = nf90\_inquire\_dimension(ncid, bnd\_dim\_id, len=bnd\_dim\_len)         \textcolor{comment}{! bnd dimension length
       (should be 3).}
713     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
714 
715     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"stru"}, stru\_dim\_id)                         \textcolor{comment}{! stru dimension.}
716     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
717     iost    = nf90\_inquire\_dimension(ncid, stru\_dim\_id, len=stru\_dim\_len)       \textcolor{comment}{! stru dimension length.}
718     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
719 
720     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"strs"}, strs\_dim\_id)                         \textcolor{comment}{! strs dimension.}
721     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
722     iost    = nf90\_inquire\_dimension(ncid, strs\_dim\_id, len=strs\_dim\_len)       \textcolor{comment}{! strs dimension length.}
723     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
724 
725     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"weight"}, weight\_dim\_id)                     \textcolor{comment}{! weight dimension.}
726     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
727     iost    = nf90\_inquire\_dimension(ncid, weight\_dim\_id, len=weight\_dim\_len)   \textcolor{comment}{! weight dimension length.}
728     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
729 
730     \textcolor{comment}{!}
731     \textcolor{comment}{! Read in the data. Only read those variables which the user requests in the optional subroutine
       arguments.}
732     \textcolor{comment}{! When allocating memory, be paranoid, check it hasn't already been allocated.}
733     \textcolor{comment}{!}
734     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(du)) \textcolor{keywordflow}{THEN}
735         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(du))          \textcolor{keyword}{DEALLOCATE}(du)
736         \textcolor{keyword}{ALLOCATE}(du(var\_dim\_len,lev\_dim\_len,stn\_dim\_len,t\_dim\_len), stat=memst)
737         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
738             print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: Unable to allocate memory to hold DU'}
739             stop \textcolor{stringliteral}{'1'}
740 \textcolor{keywordflow}{        END IF}
741         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"du"}, du\_var\_id)
742         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
743         iost = nf90\_get\_var(ncid, du\_var\_id, du)
744         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
745 \textcolor{keywordflow}{    END IF}
746     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(vu)) \textcolor{keywordflow}{THEN}
747         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(vu))          \textcolor{keyword}{DEALLOCATE}(vu)
748         \textcolor{keyword}{ALLOCATE}(vu(var\_dim\_len), stat=memst)
749         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
750             print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: Unable to allocate memory to hold VU'}
751             stop \textcolor{stringliteral}{'1'}
752 \textcolor{keywordflow}{        END IF}
753         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"variables"}, vu\_var\_id)
754         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
755         iost = nf90\_get\_var(ncid, vu\_var\_id, vu)
756         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
757 \textcolor{keywordflow}{    END IF}
758 
759     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(ds)) \textcolor{keywordflow}{THEN}
760         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(ds))          \textcolor{keyword}{DEALLOCATE}(ds)
761         \textcolor{keyword}{ALLOCATE}(ds(var\_dim\_len,stn\_dim\_len,t\_dim\_len), stat=memst)
762         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
763             print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: Unable to allocate memory to hold DS'}
764             stop \textcolor{stringliteral}{'1'}
765 \textcolor{keywordflow}{        END IF}
766         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"ds"}, ds\_var\_id)
767         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
768         iost = nf90\_get\_var(ncid, ds\_var\_id, ds)
769         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
770 \textcolor{keywordflow}{    END IF}
771 
772     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(t)) \textcolor{keywordflow}{THEN}
773         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(t))           \textcolor{keyword}{DEALLOCATE}(t)
774         \textcolor{keyword}{ALLOCATE}(t(t\_dim\_len), stat=memst)
775         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
776             print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: Unable to allocate memory to hold T'}
777             stop \textcolor{stringliteral}{'1'}
778 \textcolor{keywordflow}{        END IF}
779         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"time"}, t\_var\_id)
780         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
781         iost = nf90\_get\_var(ncid, t\_var\_id, t)
782         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
783 \textcolor{keywordflow}{    END IF}
784 
785     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(stn)) \textcolor{keywordflow}{THEN}
786         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(stn))         \textcolor{keyword}{DEALLOCATE}(stn)
787         \textcolor{keyword}{ALLOCATE}(stn(stn\_dim\_len), stat=memst)
788         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
789             print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: Unable to allocate memory to hold STN'}
790             stop \textcolor{stringliteral}{'1'}
791 \textcolor{keywordflow}{        END IF}
792         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"stations"}, stn\_var\_id)
793         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
794         iost = nf90\_get\_var(ncid, stn\_var\_id, stn)
795         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
796 \textcolor{keywordflow}{    END IF}
797 
798     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(lev)) \textcolor{keywordflow}{THEN}
799         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(lev))         \textcolor{keyword}{DEALLOCATE}(lev)
800         \textcolor{keyword}{ALLOCATE}(lev(lev\_dim\_len), stat=memst)
801         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
802             print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: Unable to allocate memory to hold LEV'}
803             stop \textcolor{stringliteral}{'1'}
804 \textcolor{keywordflow}{        END IF}
805         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"levels"}, lev\_var\_id)
806         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
807         iost = nf90\_get\_var(ncid, lev\_var\_id, lev)
808         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
809 \textcolor{keywordflow}{    END IF}
810 
811     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(boundary)) \textcolor{keywordflow}{THEN}
812         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(boundary))    \textcolor{keyword}{DEALLOCATE}(boundary)
813         \textcolor{keyword}{ALLOCATE}(boundary(bnd\_dim\_len,t\_dim\_len), stat=memst)
814         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
815             print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: Unable to allocate memory to hold BOUNDARY'}
816             stop \textcolor{stringliteral}{'1'}
817 \textcolor{keywordflow}{        END IF}
818         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"boundary"}, boundary\_var\_id)
819         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
820         iost = nf90\_get\_var(ncid, boundary\_var\_id, boundary)
821         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
822 \textcolor{keywordflow}{    END IF}
823 
824     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(stru)) \textcolor{keywordflow}{THEN}
825         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(stru))        \textcolor{keyword}{DEALLOCATE}(stru)
826         \textcolor{keyword}{ALLOCATE}(stru(stru\_dim\_len), stat=memst)
827         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
828             print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: Unable to allocate memory to hold STRU'}
829             stop \textcolor{stringliteral}{'1'}
830 \textcolor{keywordflow}{        END IF}
831         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"stru"}, stru\_var\_id)
832         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
833         iost = nf90\_get\_var(ncid, stru\_var\_id, stru)
834         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
835 \textcolor{keywordflow}{    END IF}
836 
837     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(strs)) \textcolor{keywordflow}{THEN}
838         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(strs))        \textcolor{keyword}{DEALLOCATE}(strs)
839         \textcolor{keyword}{ALLOCATE}(strs(strs\_dim\_len), stat=memst)
840         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
841             print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: Unable to allocate memory to hold STRS'}
842             stop \textcolor{stringliteral}{'1'}
843 \textcolor{keywordflow}{        END IF}
844         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"strs"}, strs\_var\_id)
845         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
846         iost = nf90\_get\_var(ncid, strs\_var\_id, strs)
847         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
848 \textcolor{keywordflow}{    END IF}
849 
850     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(weight)) \textcolor{keywordflow}{THEN}
851         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(weight))        \textcolor{keyword}{DEALLOCATE}(weight)
852         \textcolor{keyword}{ALLOCATE}(weight(weight\_dim\_len), stat=memst)
853         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
854             print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: Unable to allocate memory to hold WEIGHT'}
855             stop \textcolor{stringliteral}{'1'}
856 \textcolor{keywordflow}{        END IF}
857         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"weight"}, weight\_var\_id)
858         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
859         iost = nf90\_get\_var(ncid, weight\_var\_id, weight)
860         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
861 \textcolor{keywordflow}{    END IF}
862 
863     \textcolor{comment}{!}
864     \textcolor{comment}{! Close the NetCDF file.}
865     \textcolor{comment}{!}
866     iost    = nf90\_close(ncid)
867     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
868 
869     \textcolor{comment}{!}
870     \textcolor{comment}{! Catch any NetCDF errors here.}
871     \textcolor{comment}{!}
872     9999 \textcolor{keywordflow}{CONTINUE}
873     \textcolor{keywordflow}{IF} (ncerror) \textcolor{keywordflow}{THEN}
874         print *,\textcolor{stringliteral}{'E: IPT\_3D\_NETCDF: NetCDF error encountered'}
875         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
876             print *, trim(nf90\_strerror(iost))
877 \textcolor{keywordflow}{        END IF}
878         stop \textcolor{stringliteral}{'1'}
879 \textcolor{keywordflow}{    END IF}
880 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=307pt]{namespaceio_a0f9f8edb9a7173638e450ce3c4db7844_icgraph}
\end{center}
\end{figure}


\index{io@{io}!ipt\+\_\+budget\+\_\+netcdf@{ipt\+\_\+budget\+\_\+netcdf}}
\index{ipt\+\_\+budget\+\_\+netcdf@{ipt\+\_\+budget\+\_\+netcdf}!io@{io}}
\subsubsection[{\texorpdfstring{ipt\+\_\+budget\+\_\+netcdf(\+I\+N\+P\+U\+T\+F\+I\+L\+E, B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+M\+N, B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+E\+R, V\+B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+M\+N, V\+B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+E\+R, A\+V\+E\+\_\+\+Q\+S, A\+V\+E\+\_\+\+S\+S, P, T)}{ipt_budget_netcdf(INPUTFILE, BUDGET_COLUMN, BUDGET_LAYER, VBUDGET_COLUMN, VBUDGET_LAYER, AVE_QS, AVE_SS, P, T)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::ipt\+\_\+budget\+\_\+netcdf (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{I\+N\+P\+U\+T\+F\+I\+LE, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:), intent(out), optional, allocatable}]{B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+MN, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:,\+:), intent(out), optional, allocatable}]{B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+ER, }
\item[{character (len=64), dimension(\+:,\+:), intent(out), optional, allocatable}]{V\+B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+MN, }
\item[{character (len=64), dimension(\+:,\+:), intent(out), optional, allocatable}]{V\+B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+ER, }
\item[{real (kind=rk8), dimension(\+:), intent(out), optional, allocatable}]{A\+V\+E\+\_\+\+QS, }
\item[{real (kind=rk8), dimension(\+:), intent(out), optional, allocatable}]{A\+V\+E\+\_\+\+SS, }
\item[{real (kind=rk8), dimension(\+:), intent(out), optional, allocatable}]{P, }
\item[{real (kind=rk8), dimension(\+:), intent(out), optional, allocatable}]{T}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_aba707a842ac0a3e2e9def20af0b36c32}{}\label{namespaceio_aba707a842ac0a3e2e9def20af0b36c32}


Definition at line 1070 of file io.\+f90.


\begin{DoxyCode}
1070     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
1071     \textcolor{keywordtype}{USE }netcdf
1072 
1073     \textcolor{keywordtype}{IMPLICIT NONE}
1074 
1075     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                           :: inputfile    \textcolor{comment}{! Name of the
       input file.}
1076     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}   :: budget\_column
1077     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:,:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL} :: budget\_layer
1078     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}  :: vbudget\_column
1079     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}  :: vbudget\_layer
1080     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}       :: ave\_qs
1081     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}       :: ave\_ss
1082     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}       :: p
1083     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(OUT)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{OPTIONAL}       :: t
1084 
1085     \textcolor{comment}{!}
1086     \textcolor{comment}{! Local variables.}
1087     \textcolor{comment}{!}
1088     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ncid                                                 \textcolor{comment}{! ID of NetCDF
       file.}
1089 
1090     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: bcv\_dim\_id, bct\_dim\_id, blv\_dim\_id, blt\_dim\_id, p\_dim\_id, t\_dim\_id, 
      str\_dim\_id
1091     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: bcv\_dim\_len, bct\_dim\_len, blv\_dim\_len, blt\_dim\_len, p\_dim\_len, t\_dim\_len
      , str\_dim\_len
1092     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: bc\_var\_id, bl\_var\_id, vbc\_var\_id, vbl\_var\_id, ave\_qs\_var\_id, 
      ave\_ss\_var\_id, p\_var\_id, t\_var\_id
1093     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: memst                                                \textcolor{comment}{! Status of memory
       allocations.}
1094     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: iost                                                 \textcolor{comment}{! I/O status.}
1095     \textcolor{keywordtype}{LOGICAL}                     :: ncerror
1096 
1097     iost    = nf90\_noerr
1098     ncerror = .false.
1099     \textcolor{comment}{!}
1100     \textcolor{comment}{! Open the NetCDF file.}
1101     \textcolor{comment}{!}
1102     iost    = nf90\_open(inputfile, nf90\_nowrite, ncid)
1103     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1104 
1105     \textcolor{comment}{!}
1106     \textcolor{comment}{! Get the dimension IDs, and the length of the dimensions.}
1107     \textcolor{comment}{!}
1108     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"time"}, t\_dim\_id)                            \textcolor{comment}{! Time steps.}
1109     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1110     iost    = nf90\_inquire\_dimension(ncid, t\_dim\_id, len=t\_dim\_len)             \textcolor{comment}{! Get the number of time
       steps.}
1111     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1112 
1113     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"levels"}, p\_dim\_id)                          \textcolor{comment}{! Pressure levels.}
1114     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1115     iost    = nf90\_inquire\_dimension(ncid, p\_dim\_id, len=p\_dim\_len)             \textcolor{comment}{! Get number of levels.}
1116     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1117 
1118     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"string"}, str\_dim\_id)                        \textcolor{comment}{! String dimension.}
1119     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1120     iost    = nf90\_inquire\_dimension(ncid, str\_dim\_id, len=str\_dim\_len)         \textcolor{comment}{! String length.}
1121     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1122     \textcolor{keywordflow}{IF} (str\_dim\_len .NE. 64) \textcolor{keywordflow}{THEN}
1123         print *,\textcolor{stringliteral}{'E: STRING dimension length is not 64'}
1124         \textcolor{keywordflow}{GO TO} 9999
1125 \textcolor{keywordflow}{    END IF}
1126 
1127     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"bcv"}, bcv\_dim\_id)
1128     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1129     iost    = nf90\_inquire\_dimension(ncid, bcv\_dim\_id, len=bcv\_dim\_len)
1130     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1131 
1132     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"bct"}, bct\_dim\_id)
1133     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1134     iost    = nf90\_inquire\_dimension(ncid, bct\_dim\_id, len=bct\_dim\_len)
1135     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1136 
1137     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"blv"}, blv\_dim\_id)
1138     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1139     iost    = nf90\_inquire\_dimension(ncid, blv\_dim\_id, len=blv\_dim\_len)
1140     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1141 
1142     iost    = nf90\_inq\_dimid(ncid, \textcolor{stringliteral}{"blt"}, blt\_dim\_id)
1143     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1144     iost    = nf90\_inquire\_dimension(ncid, blt\_dim\_id, len=blt\_dim\_len)
1145     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1146 
1147     \textcolor{comment}{!}
1148     \textcolor{comment}{! Read in the data. Only read those variables which the user requests in the optional subroutine
       arguments.}
1149     \textcolor{comment}{! When allocating memory, be paranoid, check it hasn't already been allocated.}
1150     \textcolor{comment}{!}
1151     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(budget\_column)) \textcolor{keywordflow}{THEN}
1152         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(budget\_column))          \textcolor{keyword}{DEALLOCATE}(budget\_column)
1153         \textcolor{keyword}{ALLOCATE}(budget\_column(bcv\_dim\_len,bct\_dim\_len,t\_dim\_len), stat=memst)
1154         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
1155             print *,\textcolor{stringliteral}{'E: IPT\_BUDGET\_NETCDF: Unable to allocate memory to hold BUDGET\_COLUMN'}
1156             stop \textcolor{stringliteral}{'1'}
1157 \textcolor{keywordflow}{        END IF}
1158         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"budget\_column"}, bc\_var\_id)
1159         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1160         iost = nf90\_get\_var(ncid, bc\_var\_id, budget\_column)
1161         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1162 \textcolor{keywordflow}{    END IF}
1163 
1164     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(budget\_layer)) \textcolor{keywordflow}{THEN}
1165         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(budget\_layer))          \textcolor{keyword}{DEALLOCATE}(budget\_layer)
1166         \textcolor{keyword}{ALLOCATE}(budget\_layer(blv\_dim\_len,blt\_dim\_len,p\_dim\_len,t\_dim\_len), stat=memst)
1167         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
1168             print *,\textcolor{stringliteral}{'E: IPT\_BUDGET\_NETCDF: Unable to allocate memory to hold BUDGET\_LAYER'}
1169             stop \textcolor{stringliteral}{'1'}
1170 \textcolor{keywordflow}{        END IF}
1171         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"budget\_layer"}, bl\_var\_id)
1172         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1173         iost = nf90\_get\_var(ncid, bl\_var\_id, budget\_layer)
1174         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1175 \textcolor{keywordflow}{    END IF}
1176 
1177     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(vbudget\_column)) \textcolor{keywordflow}{THEN}
1178         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(vbudget\_column))          \textcolor{keyword}{DEALLOCATE}(vbudget\_column)
1179         \textcolor{keyword}{ALLOCATE}(vbudget\_column(bcv\_dim\_len,bct\_dim\_len), stat=memst)
1180         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
1181             print *,\textcolor{stringliteral}{'E: IPT\_BUDGET\_NETCDF: Unable to allocate memory to hold VBUDGET\_COLUMN'}
1182             stop \textcolor{stringliteral}{'1'}
1183 \textcolor{keywordflow}{        END IF}
1184         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"vbudget\_column"}, vbc\_var\_id)
1185         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1186         iost = nf90\_get\_var(ncid, vbc\_var\_id, vbudget\_column)
1187         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1188 \textcolor{keywordflow}{    END IF}
1189 
1190     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(vbudget\_layer)) \textcolor{keywordflow}{THEN}
1191         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(vbudget\_layer))          \textcolor{keyword}{DEALLOCATE}(vbudget\_layer)
1192         \textcolor{keyword}{ALLOCATE}(vbudget\_layer(blv\_dim\_len,blt\_dim\_len), stat=memst)
1193         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
1194             print *,\textcolor{stringliteral}{'E: IPT\_BUDGET\_NETCDF: Unable to allocate memory to hold VBUDGET\_LAYER'}
1195             stop \textcolor{stringliteral}{'1'}
1196 \textcolor{keywordflow}{        END IF}
1197         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"vbudget\_layer"}, vbl\_var\_id)
1198         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1199         iost = nf90\_get\_var(ncid, vbl\_var\_id, vbudget\_layer)
1200         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1201 \textcolor{keywordflow}{    END IF}
1202 
1203     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(ave\_qs)) \textcolor{keywordflow}{THEN}
1204         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(ave\_qs))           \textcolor{keyword}{DEALLOCATE}(ave\_qs)
1205         \textcolor{keyword}{ALLOCATE}(ave\_qs(t\_dim\_len), stat=memst)
1206         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
1207             print *,\textcolor{stringliteral}{'E: IPT\_BUDGET\_NETCDF: Unable to allocate memory to hold AVE\_QS'}
1208             stop \textcolor{stringliteral}{'1'}
1209 \textcolor{keywordflow}{        END IF}
1210         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"ave\_qs"}, ave\_qs\_var\_id)
1211         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1212         iost = nf90\_get\_var(ncid, ave\_qs\_var\_id, ave\_qs)
1213         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1214 \textcolor{keywordflow}{    END IF}
1215 
1216     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(ave\_ss)) \textcolor{keywordflow}{THEN}
1217         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(ave\_ss))           \textcolor{keyword}{DEALLOCATE}(ave\_ss)
1218         \textcolor{keyword}{ALLOCATE}(ave\_ss(t\_dim\_len), stat=memst)
1219         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
1220             print *,\textcolor{stringliteral}{'E: IPT\_BUDGET\_NETCDF: Unable to allocate memory to hold AVE\_SS'}
1221             stop \textcolor{stringliteral}{'1'}
1222 \textcolor{keywordflow}{        END IF}
1223         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"ave\_ss"}, ave\_ss\_var\_id)
1224         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1225         iost = nf90\_get\_var(ncid, ave\_ss\_var\_id, ave\_ss)
1226         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1227 \textcolor{keywordflow}{    END IF}
1228 
1229     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(p)) \textcolor{keywordflow}{THEN}
1230         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(p))         \textcolor{keyword}{DEALLOCATE}(p)
1231         \textcolor{keyword}{ALLOCATE}(p(p\_dim\_len), stat=memst)
1232         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
1233             print *,\textcolor{stringliteral}{'E: IPT\_BUDGET\_NETCDF: Unable to allocate memory to hold P'}
1234             stop \textcolor{stringliteral}{'1'}
1235 \textcolor{keywordflow}{        END IF}
1236         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"levels"}, p\_var\_id)
1237         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1238         iost = nf90\_get\_var(ncid, p\_var\_id, p)
1239         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1240 \textcolor{keywordflow}{    END IF}
1241 
1242     \textcolor{keywordflow}{IF} (\textcolor{keyword}{PRESENT}(t)) \textcolor{keywordflow}{THEN}
1243         \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(t))           \textcolor{keyword}{DEALLOCATE}(t)
1244         \textcolor{keyword}{ALLOCATE}(t(t\_dim\_len), stat=memst)
1245         \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
1246             print *,\textcolor{stringliteral}{'E: IPT\_BUDGET\_NETCDF: Unable to allocate memory to hold T'}
1247             stop \textcolor{stringliteral}{'1'}
1248 \textcolor{keywordflow}{        END IF}
1249         iost = nf90\_inq\_varid(ncid, \textcolor{stringliteral}{"time"}, t\_var\_id)
1250         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1251         iost = nf90\_get\_var(ncid, t\_var\_id, t)
1252         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1253 \textcolor{keywordflow}{    END IF}
1254 
1255     \textcolor{comment}{!}
1256     \textcolor{comment}{! Close the NetCDF file.}
1257     \textcolor{comment}{!}
1258     iost    = nf90\_close(ncid)
1259     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1260 
1261     \textcolor{comment}{!}
1262     \textcolor{comment}{! Catch any NetCDF errors here.}
1263     \textcolor{comment}{!}
1264     9999 \textcolor{keywordflow}{CONTINUE}
1265     \textcolor{keywordflow}{IF} (ncerror) \textcolor{keywordflow}{THEN}
1266         print *,\textcolor{stringliteral}{'E: IPT\_BUDGET\_NETCDF: NetCDF error encountered'}
1267         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
1268             print *, trim(nf90\_strerror(iost))
1269 \textcolor{keywordflow}{        END IF}
1270         stop \textcolor{stringliteral}{'1'}
1271 \textcolor{keywordflow}{    END IF}
1272 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=325pt]{namespaceio_aba707a842ac0a3e2e9def20af0b36c32_icgraph}
\end{center}
\end{figure}


\index{io@{io}!ipt\+\_\+ht@{ipt\+\_\+ht}}
\index{ipt\+\_\+ht@{ipt\+\_\+ht}!io@{io}}
\subsubsection[{\texorpdfstring{ipt\+\_\+ht(\+I\+N\+P\+U\+T\+F\+I\+L\+E, I\+N\+S\+T\+R\+U\+M\+E\+N\+T, N\+V, N\+S\+T, N\+T, V, S\+T, L\+O\+N, L\+A\+T, T, D)}{ipt_ht(INPUTFILE, INSTRUMENT, NV, NST, NT, V, ST, LON, LAT, T, D)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::ipt\+\_\+ht (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{I\+N\+P\+U\+T\+F\+I\+LE, }
\item[{character (len=64), intent(out)}]{I\+N\+S\+T\+R\+U\+M\+E\+NT, }
\item[{integer (kind=ik4), intent(out)}]{NV, }
\item[{integer (kind=ik4), intent(out)}]{N\+ST, }
\item[{integer (kind=ik4), intent(out)}]{NT, }
\item[{character (len=64), dimension(\+:), intent(out), allocatable}]{V, }
\item[{character (len=64), dimension(\+:), intent(out), allocatable}]{ST, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{L\+ON, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{L\+AT, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{T, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:), intent(out), allocatable}]{D}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_ae478b0148dea487c688bfea00e08cade}{}\label{namespaceio_ae478b0148dea487c688bfea00e08cade}


Definition at line 163 of file io.\+f90.


\begin{DoxyCode}
163     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
164 
165     \textcolor{keywordtype}{IMPLICIT NONE}
166 
167     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: inputfile    \textcolor{comment}{! Input data
       filename.}
168     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{INTENT(OUT)}                                     :: instrument   \textcolor{comment}{! Name of
       instrument which created the data.}
169     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(OUT)}                                     :: nv           \textcolor{comment}{! Number of
       variables?}
170     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(OUT)}                                     :: nst          \textcolor{comment}{! Number of
       stations.}
171     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(OUT)}                                     :: nt           \textcolor{comment}{! Number of time
       steps.}
172     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}          :: v            \textcolor{comment}{! Names of the
       variables.}
173     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}          :: st           \textcolor{comment}{! Names of the
       stations.}
174     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}             :: lon          \textcolor{comment}{! Longitudes of the
       stations.}
175     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}             :: lat          \textcolor{comment}{! Latitudes of the
       stations.}
176     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}             :: t            \textcolor{comment}{! Time steps.}
177     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}         :: d            \textcolor{comment}{! The data.}
178 
179     \textcolor{comment}{!}
180     \textcolor{comment}{! Local variables.}
181     \textcolor{comment}{!}
182     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                                                  :: iost         \textcolor{comment}{! Status of IO
       operations.}
183     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                                                  :: memst        \textcolor{comment}{! Status of memory
       allocation operations.}
184     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                                                  :: ii, jj, kk   \textcolor{comment}{! Counters.}
185 
186     iost    = 0
187     print *,\textcolor{stringliteral}{'I: Reading data from '},inputfile
188 
189     \textcolor{comment}{!}
190     \textcolor{comment}{! Open the data file. Be cautious, and don't let the file be written to.}
191     \textcolor{comment}{!}
192     \textcolor{keyword}{OPEN} (unit=100, iostat=iost, err=9999, file=inputfile, status=\textcolor{stringliteral}{'OLD'}, access=\textcolor{stringliteral}{'SEQUENTIAL'}, form=\textcolor{stringliteral}{
      'FORMATTED'}, action=\textcolor{stringliteral}{'READ'})
193 
194     \textcolor{comment}{!}
195     \textcolor{comment}{! Read the file headers.}
196     \textcolor{comment}{!}
197     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(A64)'}, unit=100, err=9999, iostat=iost) instrument         \textcolor{comment}{! Name of the instrument
       producing the data.}
198     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(I6)'}, unit=100, err=9999, iostat=iost) nv                  \textcolor{comment}{! Number of variables.}
199     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(I6)'}, unit=100, err=9999, iostat=iost) nst                 \textcolor{comment}{! Number of stations.}
200     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(I6)'}, unit=100, err=9999, iostat=iost) nt                  \textcolor{comment}{! Number of time steps.}
201 
202     \textcolor{comment}{!}
203     \textcolor{comment}{! Allocate enough space in the data arrays. We might as well be paranoid, and check if the arrays have
       already been}
204     \textcolor{comment}{! allocated (and if so, deallocate them).}
205     \textcolor{comment}{!}
206     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(v))   \textcolor{keyword}{DEALLOCATE}(v)
207     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(st))  \textcolor{keyword}{DEALLOCATE}(st)
208     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(lon)) \textcolor{keyword}{DEALLOCATE}(lon)
209     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(lat)) \textcolor{keyword}{DEALLOCATE}(lat)
210     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(d))   \textcolor{keyword}{DEALLOCATE}(d)
211 
212     \textcolor{keyword}{ALLOCATE}(v(nv), st(nst), lon(nst), lat(nst), t(nt), d(nv,nst,nt), stat=memst)
213     \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
214         print *,\textcolor{stringliteral}{'E: Unable to allocate memory to hold 2D data'}
215         stop \textcolor{stringliteral}{'1'}
216 \textcolor{keywordflow}{    END IF}
217 
218     \textcolor{comment}{!}
219     \textcolor{comment}{! Read the data arrays.}
220     \textcolor{comment}{!}
221     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(A64)'}, unit=100, err=9999, iostat=iost) (v(ii), ii=1,nv)       \textcolor{comment}{! Read the variable names.}
222     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(A64)'}, unit=100, err=9999, iostat=iost) (st(ii), ii=1,nst)     \textcolor{comment}{! Read the station names.}
223     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(F10.5)'}, unit=100, err=9999, iostat=iost) (lon(ii), ii=1,nst)  \textcolor{comment}{! Read the station
       longitudes.}
224     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(F10.5)'}, unit=100, err=9999, iostat=iost) (lat(ii), ii=1,nst)  \textcolor{comment}{! Read the station
       latitudes.}
225     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(F10.5)'}, unit=100, err=9999, iostat=iost) (t(ii), ii=1,nt)     \textcolor{comment}{! Read the times.}
226 
227     \textcolor{comment}{!}
228     \textcolor{comment}{! Read all the data. Don't know how (or if) this can be done with an implicit do loop, therefore will
       do it the old fashioned}
229     \textcolor{comment}{! way.}
230     \textcolor{comment}{!}
231     \textcolor{keywordflow}{DO} kk=1,nt
232         \textcolor{keywordflow}{DO} jj=1,nst
233             \textcolor{keywordflow}{DO} ii=1,nv
234                 \textcolor{keyword}{READ}(fmt=\textcolor{stringliteral}{'(F10.3)'}, unit=100, err=9999, iostat=iost) d(ii,jj,kk)
235 \textcolor{keywordflow}{            END DO}
236 \textcolor{keywordflow}{        END DO}
237 \textcolor{keywordflow}{    END DO}
238 
239     \textcolor{comment}{!}
240     \textcolor{comment}{! Close the data file.}
241     \textcolor{comment}{!}
242     \textcolor{keyword}{CLOSE} (unit=100, err=9999, iostat=iost, status=\textcolor{stringliteral}{'KEEP'})
243 
244     \textcolor{comment}{!}
245     \textcolor{comment}{! The next block of code deals with IO errors (if they occurred).}
246     \textcolor{comment}{!}
247     9999 \textcolor{keywordflow}{CONTINUE}
248     \textcolor{keywordflow}{IF} (iost .GT. 0) \textcolor{keywordflow}{THEN}
249         print *,\textcolor{stringliteral}{'E: An IO error occurred while reading '},inputfile
250         stop \textcolor{stringliteral}{'1'}
251 \textcolor{keywordflow}{    END IF}
252 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=269pt]{namespaceio_ae478b0148dea487c688bfea00e08cade_icgraph}
\end{center}
\end{figure}


\index{io@{io}!ipt\+\_\+vht@{ipt\+\_\+vht}}
\index{ipt\+\_\+vht@{ipt\+\_\+vht}!io@{io}}
\subsubsection[{\texorpdfstring{ipt\+\_\+vht(\+I\+N\+P\+U\+T\+F\+I\+L\+E, I\+N\+S\+T\+R\+U\+M\+E\+N\+T, N\+V, N\+P, N\+S\+T, N\+T, V, P, S\+T, T, D)}{ipt_vht(INPUTFILE, INSTRUMENT, NV, NP, NST, NT, V, P, ST, T, D)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::ipt\+\_\+vht (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{I\+N\+P\+U\+T\+F\+I\+LE, }
\item[{character (len=64), intent(out)}]{I\+N\+S\+T\+R\+U\+M\+E\+NT, }
\item[{integer (kind=ik4), intent(out)}]{NV, }
\item[{integer (kind=ik4), intent(out)}]{NP, }
\item[{integer (kind=ik4), intent(out)}]{N\+ST, }
\item[{integer (kind=ik4), intent(out)}]{NT, }
\item[{character (len=64), dimension(\+:), intent(out), allocatable}]{V, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{P, }
\item[{character (len=64), dimension(\+:), intent(out), allocatable}]{ST, }
\item[{real (kind=rk8), dimension(\+:), intent(out), allocatable}]{T, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:,\+:), intent(out), allocatable}]{D}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_abed61f2af0a37265b7a1d15300f61996}{}\label{namespaceio_abed61f2af0a37265b7a1d15300f61996}


Definition at line 46 of file io.\+f90.


\begin{DoxyCode}
46     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
47 
48     \textcolor{keywordtype}{IMPLICIT NONE}
49     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: inputfile    \textcolor{comment}{! Name of the input
       file.}
50     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{INTENT(OUT)}                                     :: instrument   \textcolor{comment}{! Instrument name.}
51     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(OUT)}                                     :: nv           \textcolor{comment}{! Number of
       variables?}
52     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(OUT)}                                     :: np           \textcolor{comment}{! Number of
       pressure levels.}
53     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(OUT)}                                     :: nst          \textcolor{comment}{! Number of
       stations.}
54     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(OUT)}                                     :: nt           \textcolor{comment}{! Number of time
       steps.}
55     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}          :: v            \textcolor{comment}{! Variable names?}
56     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}             :: p            \textcolor{comment}{! Values of the
       pressure levels.}
57     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}          :: st           \textcolor{comment}{! Station names?}
58     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}             :: t            \textcolor{comment}{! Time values?}
59     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:,:)}, \textcolor{keywordtype}{ALLOCATABLE}, \textcolor{keywordtype}{INTENT(OUT)}       :: d            \textcolor{comment}{! The data.}
60 
61     \textcolor{comment}{!}
62     \textcolor{comment}{! Local variables.}
63     \textcolor{comment}{!}
64     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                                                  :: iost         \textcolor{comment}{! IO status (0 (OK)
       or +ve (error))}
65     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                                                  :: memst        \textcolor{comment}{! Status from
       ALLOCATE commands.}
66     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                                                  :: ii,jj,kk,ll  \textcolor{comment}{! Counters}
67 
68     iost = 0
69     print *,\textcolor{stringliteral}{'I: Reading data from '},inputfile
70 
71     \textcolor{comment}{!}
72     \textcolor{comment}{! Open the data file. Be cautious, and don't let the file be written to.}
73     \textcolor{comment}{!}
74     \textcolor{keyword}{OPEN} (unit=100, iostat=iost, err=9999, file=inputfile, status=\textcolor{stringliteral}{'OLD'}, access=\textcolor{stringliteral}{'SEQUENTIAL'}, form=\textcolor{stringliteral}{
      'FORMATTED'}, action=\textcolor{stringliteral}{'READ'})
75 
76     \textcolor{comment}{!}
77     \textcolor{comment}{! Read the file headers.}
78     \textcolor{comment}{!}
79     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(A64)'}, unit=100, err=9999, iostat=iost) instrument         \textcolor{comment}{! Name of the instrument
       producing the data.}
80     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(I6)'}, unit=100, err=9999, iostat=iost) nv                  \textcolor{comment}{! Number of variables.}
81     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(I6)'}, unit=100, err=9999, iostat=iost) np                  \textcolor{comment}{! Number of pressure levels.}
82     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(I6)'}, unit=100, err=9999, iostat=iost) nst                 \textcolor{comment}{! Number of stations.}
83     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(I6)'}, unit=100, err=9999, iostat=iost) nt                  \textcolor{comment}{! Number of time steps.}
84 
85     \textcolor{comment}{!}
86     \textcolor{comment}{! Allocate enough space in the data arrays. We might as well be paranoid, and check if the arrays have
       already been}
87     \textcolor{comment}{! allocated (and if so, deallocate them).}
88     \textcolor{comment}{!}
89     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(v))   \textcolor{keyword}{DEALLOCATE}(v)
90     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(p))   \textcolor{keyword}{DEALLOCATE}(p)
91     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(st))  \textcolor{keyword}{DEALLOCATE}(st)
92     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(t))   \textcolor{keyword}{DEALLOCATE}(t)
93     \textcolor{keywordflow}{IF} (\textcolor{keyword}{ALLOCATED}(d))   \textcolor{keyword}{DEALLOCATE}(d)
94 
95     \textcolor{keyword}{ALLOCATE}(v(nv), p(np), st(nst), t(nt), d(nv,np,nst,nt), stat=memst)
96     \textcolor{keywordflow}{IF} (memst .NE. 0) \textcolor{keywordflow}{THEN}
97         print *,\textcolor{stringliteral}{'E: Unable to allocate memory to hold 3D data'}
98         stop \textcolor{stringliteral}{'1'}
99 \textcolor{keywordflow}{    END IF}
100 
101     \textcolor{comment}{!}
102     \textcolor{comment}{! Read the data arrays.}
103     \textcolor{comment}{!}
104     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(A64)'}, unit=100, err=9999, iostat=iost) (v(ii), ii=1,nv)       \textcolor{comment}{! Read the variable names.}
105     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(F7.2)'}, unit=100, err=9999, iostat=iost) (p(ii), ii=1,np)      \textcolor{comment}{! Read the pressure levels.}
106     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(A64)'}, unit=100, err=9999, iostat=iost) (st(ii), ii=1,nst)     \textcolor{comment}{! Read the station names.}
107     \textcolor{keyword}{READ} (fmt=\textcolor{stringliteral}{'(F10.5)'}, unit=100, err=9999, iostat=iost) (t(ii), ii=1,nt)     \textcolor{comment}{! Read the times.}
108 
109     \textcolor{comment}{!}
110     \textcolor{comment}{! Read all the data. Don't know how (or if) this can be done with an implicit do loop, therefore will
       do it the old fashioned}
111     \textcolor{comment}{! way.}
112     \textcolor{comment}{!}
113     \textcolor{keywordflow}{DO} ll=1,nt
114         \textcolor{keywordflow}{DO} kk=1,nst
115             \textcolor{keywordflow}{DO} jj=1,np
116                 \textcolor{keywordflow}{DO} ii=1,nv
117                     \textcolor{keyword}{READ}(fmt=\textcolor{stringliteral}{'(F10.3)'}, unit=100, err=9999, iostat=iost) d(ii,jj,kk,ll)
118 \textcolor{keywordflow}{                END DO}
119 \textcolor{keywordflow}{            END DO}
120 \textcolor{keywordflow}{        END DO}
121 \textcolor{keywordflow}{    END DO}
122 
123     \textcolor{comment}{!}
124     \textcolor{comment}{! Close the data file.}
125     \textcolor{comment}{!}
126     \textcolor{keyword}{CLOSE} (unit=100, err=9999, iostat=iost, status=\textcolor{stringliteral}{'KEEP'})
127 
128     \textcolor{comment}{!}
129     \textcolor{comment}{! The next block of code deals with IO errors (if they occurred).}
130     \textcolor{comment}{!}
131     9999 \textcolor{keywordflow}{CONTINUE}
132     \textcolor{keywordflow}{IF} (iost .GT. 0) \textcolor{keywordflow}{THEN}
133         print *,\textcolor{stringliteral}{'E: An IO error occurred while reading '},inputfile
134         stop \textcolor{stringliteral}{'1'}
135 \textcolor{keywordflow}{    END IF}
136 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=221pt]{namespaceio_abed61f2af0a37265b7a1d15300f61996_icgraph}
\end{center}
\end{figure}


\index{io@{io}!opt\+\_\+2d\+\_\+netcdf@{opt\+\_\+2d\+\_\+netcdf}}
\index{opt\+\_\+2d\+\_\+netcdf@{opt\+\_\+2d\+\_\+netcdf}!io@{io}}
\subsubsection[{\texorpdfstring{opt\+\_\+2d\+\_\+netcdf(\+O\+U\+T\+P\+U\+T\+F\+I\+L\+E, T, B\+A\+R\+\_\+\+P\+R\+E\+S, A\+D\+P\+S, P\+R\+E\+C\+I\+P, L\+P\+R\+E\+C\+I\+P, E\+V\+A\+P\+O\+R, S\+H\+F, R\+L, R\+A\+D\+I\+A\+T\+I\+O\+N\+T, R\+A\+D\+I\+A\+T\+I\+O\+N\+B, R\+A\+D\+I\+A\+T\+I\+O\+N, T\+A\+O\+X, T\+A\+O\+Y)}{opt_2d_netcdf(OUTPUTFILE, T, BAR_PRES, ADPS, PRECIP, LPRECIP, EVAPOR, SHF, RL, RADIATIONT, RADIATIONB, RADIATION, TAOX, TAOY)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::opt\+\_\+2d\+\_\+netcdf (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{O\+U\+T\+P\+U\+T\+F\+I\+LE, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{T, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{B\+A\+R\+\_\+\+P\+R\+ES, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{A\+D\+PS, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{P\+R\+E\+C\+IP, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{L\+P\+R\+E\+C\+IP, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{E\+V\+A\+P\+OR, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{S\+HF, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{RL, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{R\+A\+D\+I\+A\+T\+I\+O\+NT, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{R\+A\+D\+I\+A\+T\+I\+O\+NB, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{R\+A\+D\+I\+A\+T\+I\+ON, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{T\+A\+OX, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{T\+A\+OY}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_ab6bcb3dc7b4a08b242b7fbd4e11ed319}{}\label{namespaceio_ab6bcb3dc7b4a08b242b7fbd4e11ed319}


Definition at line 1287 of file io.\+f90.


\begin{DoxyCode}
1287     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
1288     \textcolor{keywordtype}{USE }netcdf
1289 
1290     \textcolor{keywordtype}{IMPLICIT NONE}
1291 
1292     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: outputfile   \textcolor{comment}{! Name of the
       output file.}
1293     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: t            \textcolor{comment}{! Time.}
1294     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: bar\_pres     \textcolor{comment}{! Barometric
       pressure (hPa).}
1295     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: adps         \textcolor{comment}{! V.grad(PS)}
1296     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: precip
1297     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: lprecip
1298     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: evapor
1299     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: shf
1300     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: rl
1301     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: radiationt
1302     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: radiationb
1303     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: radiation
1304     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: taox
1305     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: taoy
1306 
1307     \textcolor{comment}{!}
1308     \textcolor{comment}{! Local variables.}
1309     \textcolor{comment}{!}
1310     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ncid                                                 \textcolor{comment}{! ID of NetCDF
       file.}
1311     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: t\_dim\_id                                             \textcolor{comment}{! Time dimension
       ID.}
1312     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: t\_var\_id                                             \textcolor{comment}{! Time coordinate
       variable.}
1313     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: bar\_pres\_var\_id
1314     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: adps\_var\_id
1315     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: precip\_var\_id
1316     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: lprecip\_var\_id
1317     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: evapor\_var\_id
1318     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: shf\_var\_id
1319     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: rl\_var\_id
1320     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: radiationt\_var\_id
1321     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: radiationb\_var\_id
1322     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: radiation\_var\_id
1323     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: taox\_var\_id
1324     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: taoy\_var\_id
1325     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: iost                                                 \textcolor{comment}{! I/O status.}
1326     \textcolor{keywordtype}{LOGICAL}                     :: ncerror                                               \textcolor{comment}{! Did a NetCDF
       function fail?}
1327 
1328     iost    = nf90\_noerr
1329     ncerror = .false.
1330     \textcolor{comment}{!}
1331     \textcolor{comment}{! Create the NetCDF file.}
1332     \textcolor{comment}{!}
1333     iost    = nf90\_create(outputfile, nf90\_noclobber, ncid)
1334     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1335 
1336     \textcolor{comment}{!}
1337     \textcolor{comment}{! Define the dimensions.}
1338     \textcolor{comment}{!}
1339     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"time"}, \textcolor{keyword}{SIZE}(t), t\_dim\_id)                          \textcolor{comment}{! Time steps.}
1340     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1341 
1342     \textcolor{comment}{!}
1343     \textcolor{comment}{! Define the variables.}
1344     \textcolor{comment}{!}
1345     ncerror = .false.
1346     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"time"}, nf90\_double, (/ t\_dim\_id /), t\_var\_id)                    .NE. 
      nf90\_noerr)
1347     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"bar\_pres"}, nf90\_double, (/ t\_dim\_id /), bar\_pres\_var\_id)         .NE. 
      nf90\_noerr) .OR. ncerror
1348     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"adps"}, nf90\_double, (/ t\_dim\_id /), adps\_var\_id)                 .NE. 
      nf90\_noerr) .OR. ncerror
1349     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"precip"}, nf90\_double, (/ t\_dim\_id /), precip\_var\_id)             .NE. 
      nf90\_noerr) .OR. ncerror
1350     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"lprecip"}, nf90\_double, (/ t\_dim\_id /), lprecip\_var\_id)           .NE. 
      nf90\_noerr) .OR. ncerror
1351     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"evapor"}, nf90\_double, (/ t\_dim\_id /), evapor\_var\_id)             .NE. 
      nf90\_noerr) .OR. ncerror
1352     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"shf"}, nf90\_double, (/ t\_dim\_id /), shf\_var\_id)                   .NE. 
      nf90\_noerr) .OR. ncerror
1353     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"rl"}, nf90\_double, (/ t\_dim\_id /), rl\_var\_id)                     .NE. 
      nf90\_noerr) .OR. ncerror
1354     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"radiationt"}, nf90\_double, (/ t\_dim\_id /), radiationt\_var\_id)     .NE. 
      nf90\_noerr) .OR. ncerror
1355     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"radiationb"}, nf90\_double, (/ t\_dim\_id /), radiationb\_var\_id)     .NE. 
      nf90\_noerr) .OR. ncerror
1356     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"radiation"}, nf90\_double, (/ t\_dim\_id /), radiation\_var\_id)       .NE. 
      nf90\_noerr) .OR. ncerror
1357     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"taox"}, nf90\_double, (/ t\_dim\_id /), taox\_var\_id)                 .NE. 
      nf90\_noerr) .OR. ncerror
1358     ncerror = (nf90\_def\_var(ncid, \textcolor{stringliteral}{"taoy"}, nf90\_double, (/ t\_dim\_id /), taoy\_var\_id)                 .NE. 
      nf90\_noerr) .OR. ncerror
1359     \textcolor{keywordflow}{IF} (ncerror) \textcolor{keywordflow}{GO TO} 9999
1360 
1361     \textcolor{comment}{!}
1362     \textcolor{comment}{! Create various attributes. Make sure strings are null terminated (for C programs).}
1363     \textcolor{comment}{!}
1364     ncerror = .false.
1365     ncerror = (nf90\_put\_att(ncid, t\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Time'}//char(0))                           .NE. 
      nf90\_noerr)
1366     ncerror = (nf90\_put\_att(ncid, t\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'Days since 2004-12-31T00:00:00 UTC'}//char(0)) .NE. 
      nf90\_noerr) .OR. ncerror
1367     ncerror = (nf90\_put\_att(ncid, t\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)                      .NE. 
      nf90\_noerr) .OR. ncerror
1368     ncerror = (nf90\_put\_att(ncid, bar\_pres\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Barometric pressure'}//char(0))     .NE. 
      nf90\_noerr) .OR. ncerror
1369     ncerror = (nf90\_put\_att(ncid, bar\_pres\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'Pa'}//char(0))                          .NE. 
      nf90\_noerr) .OR. ncerror
1370     ncerror = (nf90\_put\_att(ncid, bar\_pres\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)               .NE. 
      nf90\_noerr) .OR. ncerror
1371     ncerror = (nf90\_put\_att(ncid, adps\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'V.grad(Ps)'}//char(0))                  .NE. 
      nf90\_noerr) .OR. ncerror
1372     ncerror = (nf90\_put\_att(ncid, adps\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'Pa/s'}//char(0))                            .NE. 
      nf90\_noerr) .OR. ncerror
1373     ncerror = (nf90\_put\_att(ncid, adps\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)                   .NE. 
      nf90\_noerr) .OR. ncerror
1374     ncerror = (nf90\_put\_att(ncid, precip\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'precip * Lv0/Cpd'}//char(0))          .NE. 
      nf90\_noerr) .OR. ncerror
1375     ncerror = (nf90\_put\_att(ncid, precip\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/s'}//char(0))                           .NE. 
      nf90\_noerr) .OR. ncerror
1376     ncerror = (nf90\_put\_att(ncid, precip\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)                 .NE. 
      nf90\_noerr) .OR. ncerror
1377     ncerror = (nf90\_put\_att(ncid, lprecip\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'precip *Lv/Cpd'}//char(0))           .NE. 
      nf90\_noerr) .OR. ncerror
1378     ncerror = (nf90\_put\_att(ncid, lprecip\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/s'}//char(0))                          .NE. 
      nf90\_noerr) .OR. ncerror
1379     ncerror = (nf90\_put\_att(ncid, lprecip\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)                .NE. 
      nf90\_noerr) .OR. ncerror
1380     ncerror = (nf90\_put\_att(ncid, evapor\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Evaporation * Lv0/Cpd'}//char(0))     .NE. 
      nf90\_noerr) .OR. ncerror
1381     ncerror = (nf90\_put\_att(ncid, evapor\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/s'}//char(0))                           .NE. 
      nf90\_noerr) .OR. ncerror
1382     ncerror = (nf90\_put\_att(ncid, evapor\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)                 .NE. 
      nf90\_noerr) .OR. ncerror
1383     ncerror = (nf90\_put\_att(ncid, shf\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Sensible heating rate'}//char(0))        .NE. 
      nf90\_noerr) .OR. ncerror
1384     ncerror = (nf90\_put\_att(ncid, shf\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/s'}//char(0))                              .NE. 
      nf90\_noerr) .OR. ncerror
1385     ncerror = (nf90\_put\_att(ncid, shf\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)                    .NE. 
      nf90\_noerr) .OR. ncerror
1386     ncerror = (nf90\_put\_att(ncid, rl\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Rl * Lv0/Cpd'}//char(0))                  .NE. 
      nf90\_noerr) .OR. ncerror
1387     ncerror = (nf90\_put\_att(ncid, rl\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/s'}//char(0))                               .NE. 
      nf90\_noerr) .OR. ncerror
1388     ncerror = (nf90\_put\_att(ncid, rl\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)                     .NE. 
      nf90\_noerr) .OR. ncerror
1389     ncerror = (nf90\_put\_att(ncid, radiationt\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Radiative heating-TOA'}//char(0)) .NE. 
      nf90\_noerr) .OR. ncerror
1390     ncerror = (nf90\_put\_att(ncid, radiationt\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/s'}//char(0))                       .NE. 
      nf90\_noerr) .OR. ncerror
1391     ncerror = (nf90\_put\_att(ncid, radiationt\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)             .NE. 
      nf90\_noerr) .OR. ncerror
1392     ncerror = (nf90\_put\_att(ncid, radiationb\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Radiative heating-SFC'}//char(0)) .NE. 
      nf90\_noerr) .OR. ncerror
1393     ncerror = (nf90\_put\_att(ncid, radiationb\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/s'}//char(0))                       .NE. 
      nf90\_noerr) .OR. ncerror
1394     ncerror = (nf90\_put\_att(ncid, radiationb\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)             .NE. 
      nf90\_noerr) .OR. ncerror
1395     ncerror = (nf90\_put\_att(ncid, radiation\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Radiative heating-COL'}//char(0))  .NE. 
      nf90\_noerr) .OR. ncerror
1396     ncerror = (nf90\_put\_att(ncid, radiation\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/s'}//char(0))                        .NE. 
      nf90\_noerr) .OR. ncerror
1397     ncerror = (nf90\_put\_att(ncid, radiation\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)              .NE. 
      nf90\_noerr) .OR. ncerror
1398     ncerror = (nf90\_put\_att(ncid, taox\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'X-shearing stress'}//char(0))           .NE. 
      nf90\_noerr) .OR. ncerror
1399     ncerror = (nf90\_put\_att(ncid, taox\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'N'}//char(0))                               .NE. 
      nf90\_noerr) .OR. ncerror
1400     ncerror = (nf90\_put\_att(ncid, taox\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)                   .NE. 
      nf90\_noerr) .OR. ncerror
1401     ncerror = (nf90\_put\_att(ncid, taoy\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Y-shearing stress'}//char(0))           .NE. 
      nf90\_noerr) .OR. ncerror
1402     ncerror = (nf90\_put\_att(ncid, taoy\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'N'}//char(0))                               .NE. 
      nf90\_noerr) .OR. ncerror
1403     ncerror = (nf90\_put\_att(ncid, taoy\_var\_id, \textcolor{stringliteral}{"missing\_value"}, nf90\_fill\_double)                   .NE. 
      nf90\_noerr) .OR. ncerror
1404     \textcolor{keywordflow}{IF} (ncerror) \textcolor{keywordflow}{GO TO} 9999
1405 
1406     \textcolor{comment}{!}
1407     \textcolor{comment}{! We've finished defining stuff, leave the definition mode.}
1408     \textcolor{comment}{!}
1409     iost    = nf90\_enddef(ncid)
1410     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1411 
1412     \textcolor{comment}{!}
1413     \textcolor{comment}{! Write the data.}
1414     \textcolor{comment}{!}
1415     ncerror = .false.
1416     ncerror = (nf90\_put\_var(ncid, t\_var\_id, t)                      .NE. nf90\_noerr)
1417     ncerror = (nf90\_put\_var(ncid, bar\_pres\_var\_id, bar\_pres)        .NE. nf90\_noerr) .OR. ncerror
1418     ncerror = (nf90\_put\_var(ncid, adps\_var\_id, adps)                .NE. nf90\_noerr) .OR. ncerror
1419     ncerror = (nf90\_put\_var(ncid, precip\_var\_id, precip)            .NE. nf90\_noerr) .OR. ncerror
1420     ncerror = (nf90\_put\_var(ncid, lprecip\_var\_id, lprecip)          .NE. nf90\_noerr) .OR. ncerror
1421     ncerror = (nf90\_put\_var(ncid, evapor\_var\_id, evapor)            .NE. nf90\_noerr) .OR. ncerror
1422     ncerror = (nf90\_put\_var(ncid, shf\_var\_id, shf)                  .NE. nf90\_noerr) .OR. ncerror
1423     ncerror = (nf90\_put\_var(ncid, rl\_var\_id, rl)                    .NE. nf90\_noerr) .OR. ncerror
1424     ncerror = (nf90\_put\_var(ncid, radiationt\_var\_id, radiationt)    .NE. nf90\_noerr) .OR. ncerror
1425     ncerror = (nf90\_put\_var(ncid, radiationb\_var\_id, radiationb)    .NE. nf90\_noerr) .OR. ncerror
1426     ncerror = (nf90\_put\_var(ncid, radiation\_var\_id, radiation)      .NE. nf90\_noerr) .OR. ncerror
1427     ncerror = (nf90\_put\_var(ncid, taox\_var\_id, taox)                .NE. nf90\_noerr) .OR. ncerror
1428     ncerror = (nf90\_put\_var(ncid, taoy\_var\_id, taoy)                .NE. nf90\_noerr) .OR. ncerror
1429     \textcolor{keywordflow}{IF} (ncerror) \textcolor{keywordflow}{GO TO} 9999
1430 
1431     \textcolor{comment}{!}
1432     \textcolor{comment}{! Close the NetCDF file.}
1433     \textcolor{comment}{!}
1434     iost    = nf90\_close(ncid)
1435     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1436 
1437     \textcolor{comment}{!}
1438     \textcolor{comment}{! Catch any NetCDF errors here.}
1439     \textcolor{comment}{!}
1440     9999 \textcolor{keywordflow}{CONTINUE}
1441     \textcolor{keywordflow}{IF} (ncerror) \textcolor{keywordflow}{THEN}
1442         print *,\textcolor{stringliteral}{'E: NetCDF error encountered'}
1443         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
1444             print *, trim(nf90\_strerror(iost))
1445 \textcolor{keywordflow}{        END IF}
1446         stop \textcolor{stringliteral}{'1'}
1447 \textcolor{keywordflow}{    END IF}
1448 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=254pt]{namespaceio_ab6bcb3dc7b4a08b242b7fbd4e11ed319_icgraph}
\end{center}
\end{figure}


\index{io@{io}!opt\+\_\+3d\+\_\+netcdf@{opt\+\_\+3d\+\_\+netcdf}}
\index{opt\+\_\+3d\+\_\+netcdf@{opt\+\_\+3d\+\_\+netcdf}!io@{io}}
\subsubsection[{\texorpdfstring{opt\+\_\+3d\+\_\+netcdf(\+O\+U\+T\+P\+U\+T\+F\+I\+L\+E, D\+U, V\+U, D\+S, P, T, S\+T\+N, W\+E\+I\+G\+H\+T, B\+O\+U\+N\+D\+A\+R\+Y, S\+T\+R\+U, S\+T\+R\+S)}{opt_3d_netcdf(OUTPUTFILE, DU, VU, DS, P, T, STN, WEIGHT, BOUNDARY, STRU, STRS)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::opt\+\_\+3d\+\_\+netcdf (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{O\+U\+T\+P\+U\+T\+F\+I\+LE, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:,\+:), intent(in)}]{DU, }
\item[{character (len=64), dimension(\+:), intent(in)}]{VU, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:), intent(in)}]{DS, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{P, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{T, }
\item[{character (len=64), dimension(\+:), intent(in)}]{S\+TN, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{W\+E\+I\+G\+HT, }
\item[{integer (kind=ik4), dimension(\+:,\+:), intent(in)}]{B\+O\+U\+N\+D\+A\+RY, }
\item[{integer (kind=ik4), dimension(\+:), intent(in)}]{S\+T\+RU, }
\item[{integer (kind=ik4), dimension(\+:), intent(in)}]{S\+T\+RS}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_a63d1618c60598d1e5ac65348efb74bdc}{}\label{namespaceio_a63d1618c60598d1e5ac65348efb74bdc}


Definition at line 416 of file io.\+f90.


\begin{DoxyCode}
416     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
417     \textcolor{keywordtype}{USE }netcdf
418 
419     \textcolor{keywordtype}{IMPLICIT NONE}
420 
421     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: outputfile   \textcolor{comment}{! Name of the
       output file.}
422     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                        :: vu           \textcolor{comment}{! Names of the
       variables in DU.}
423     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:)}, \textcolor{keywordtype}{INTENT(IN)}                       :: ds           \textcolor{comment}{! Surface level
       data.}
424     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: p            \textcolor{comment}{! Pressure levels.}
425     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: t            \textcolor{comment}{! Time steps.      
          }
426     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                        :: stn          \textcolor{comment}{! Names of the
       stations.}
427     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: weight       \textcolor{comment}{! Weights for each
       station.}
428     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)}                      :: boundary     \textcolor{comment}{! BOUNDARY array.}
429     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                        :: stru         \textcolor{comment}{! STRU array.}
430     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                        :: strs         \textcolor{comment}{! STRS array.}
431     \textcolor{comment}{!}
432     \textcolor{comment}{! Local variables.}
433     \textcolor{comment}{!}
434     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ncid                                                 \textcolor{comment}{! ID of NetCDF
       file.}
435     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: v\_dim\_id, p\_dim\_id, st\_dim\_id, t\_dim\_id, str\_dim\_id, bnd\_dim\_id
436     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: stru\_dim\_id, strs\_dim\_id, weight\_dim\_id
437     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: v\_var\_id, p\_var\_id, st\_var\_id, t\_var\_id, du\_var\_id, ds\_var\_id, 
      boundary\_var\_id
438     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: stru\_var\_id, strs\_var\_id, weight\_var\_id
439     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: iost                                                 \textcolor{comment}{! I/O status.}
440     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ii                                                   \textcolor{comment}{! Counter.}
441     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: strlen                                               \textcolor{comment}{! String length.}
442     \textcolor{keywordtype}{CHARACTER (LEN=64)}          :: tmpstr                                               \textcolor{comment}{! Temporary string.}
443     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:,:)},\textcolor{keywordtype}{INTENT(IN)}                                 :: du           \textcolor{comment}{! The 3D
       data.}
444     iost    = nf90\_noerr
445     \textcolor{comment}{!}
446     \textcolor{comment}{! Create the NetCDF file.}
447     \textcolor{comment}{!}
448     iost    = nf90\_create(outputfile, nf90\_noclobber, ncid)
449     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
450 
451     \textcolor{comment}{!}
452     \textcolor{comment}{! Define the dimensions.}
453     \textcolor{comment}{!}
454     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"variables"}, \textcolor{keyword}{SIZE}(du, dim=1), v\_dim\_id)    \textcolor{comment}{! The data array contains many
       variables.}
455     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
456 
457     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"levels"}, \textcolor{keyword}{SIZE}(du, dim=2), p\_dim\_id)       \textcolor{comment}{! Vertical levels.}
458     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
459 
460     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"stations"}, \textcolor{keyword}{SIZE}(du, dim=3), st\_dim\_id)    \textcolor{comment}{! Stations.}
461     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
462 
463     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"time"}, \textcolor{keyword}{SIZE}(du, dim=4), t\_dim\_id)         \textcolor{comment}{! Time steps.}
464     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
465 
466     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"string"}, 64, str\_dim\_id)                  \textcolor{comment}{! This dimension is used for
       character strings.}
467     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
468 
469     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"bnd"}, \textcolor{keyword}{SIZE}(boundary, dim=1), bnd\_dim\_id)  \textcolor{comment}{! This dimension is used for
       the BOUNDARY array.}
470     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
471 
472     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"stru"}, \textcolor{keyword}{SIZE}(stru), stru\_dim\_id)           \textcolor{comment}{! This dimension is used for
       the STRU array.}
473     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
474 
475     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"strs"}, \textcolor{keyword}{SIZE}(strs), strs\_dim\_id)           \textcolor{comment}{! This dimension is used for
       the STRS array.}
476     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
477 
478     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"weight"}, \textcolor{keyword}{SIZE}(weight), weight\_dim\_id)     \textcolor{comment}{! This dimension is used for
       the WEIGHT array.}
479     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
480 
481     \textcolor{comment}{!}
482     \textcolor{comment}{! Define the variables.}
483     \textcolor{comment}{!}
484     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"variables"}, nf90\_char, (/ str\_dim\_id, v\_dim\_id /), v\_var\_id)
485     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
486 
487     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"levels"}, nf90\_double, (/ p\_dim\_id /), p\_var\_id)
488     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
489 
490     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"stations"}, nf90\_char, (/ str\_dim\_id, st\_dim\_id /), st\_var\_id)
491     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
492 
493     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"time"}, nf90\_double, (/ t\_dim\_id /), t\_var\_id)
494     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
495 
496     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"du"}, nf90\_double, (/ v\_dim\_id, p\_dim\_id, st\_dim\_id, t\_dim\_id /), 
      du\_var\_id)
497     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
498 
499     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"ds"}, nf90\_double, (/ v\_dim\_id, st\_dim\_id, t\_dim\_id /), ds\_var\_id)
500     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
501 
502     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"boundary"}, nf90\_int, (/ bnd\_dim\_id, t\_dim\_id /), boundary\_var\_id)
503     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
504 
505     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"stru"}, nf90\_int, (/ stru\_dim\_id /), stru\_var\_id)
506     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
507 
508     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"strs"}, nf90\_int, (/ strs\_dim\_id /), strs\_var\_id)
509     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
510 
511     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"weight"}, nf90\_double, (/ weight\_dim\_id /), weight\_var\_id)
512     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
513 
514     \textcolor{comment}{!}
515     \textcolor{comment}{! Create various attributes. Make sure strings are null terminated (for C programs).}
516     \textcolor{comment}{!}
517 \textcolor{comment}{!    IOST    = NF90\_PUT\_ATT(NCID, NF90\_GLOBAL, "instrument", TRIM(INSTRUMENT)//CHAR(0))}
518 \textcolor{comment}{!    IF (IOST .NE. NF90\_NOERR) GO TO 9999}
519     iost    = nf90\_put\_att(ncid, t\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'Days since 2004-10-01T00:00:00 UTC'}//char(0))
520     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
521     iost    = nf90\_put\_att(ncid, p\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'hPa'}//char(0))
522     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
523 
524     \textcolor{comment}{!}
525     \textcolor{comment}{! We've finished defining stuff, leave the definition mode.}
526     \textcolor{comment}{!}
527     iost    = nf90\_enddef(ncid)
528     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
529 
530     \textcolor{comment}{!}
531     \textcolor{comment}{! Write the names of the variables. Terminate strings with a null byte, in case the data are
       subsequently read by a C program.}
532     \textcolor{comment}{!}
533     \textcolor{keywordflow}{IF} (\textcolor{keyword}{SIZE}(du, dim=1) .NE. \textcolor{keyword}{SIZE}(vu)) \textcolor{keywordflow}{THEN}
534         print *,\textcolor{stringliteral}{'E: Size of variable dimension in DU is different than VU'}
535         stop \textcolor{stringliteral}{'1'}
536 \textcolor{keywordflow}{    END IF}
537 
538     \textcolor{keywordflow}{DO} ii=1,\textcolor{keyword}{SIZE}(du, dim=1)
539         tmpstr      = trim(vu(ii))
540         strlen      = min(63, len\_trim(tmpstr))           \textcolor{comment}{! The characters after this positon will be
       replaced by null characters.}
541         tmpstr(strlen+1:64)    = repeat(char(0), 64-strlen)
542         iost        = nf90\_put\_var(ncid, v\_var\_id, tmpstr, (/ 1, ii /), (/ 64, 1 /))
543         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
544 \textcolor{keywordflow}{    END DO}
545 
546     \textcolor{comment}{!}
547     \textcolor{comment}{! Write the names of the stations. Terminate strings with a null byte, in case the data are
       subsequently read by a C program.}
548     \textcolor{comment}{!}
549     \textcolor{keywordflow}{DO} ii=1,\textcolor{keyword}{SIZE}(du, dim=3)
550         tmpstr  = trim(stn(ii))
551         strlen  = min(63, len\_trim(tmpstr))           \textcolor{comment}{! The characters after this positon will be replaced
       by null characters.}
552         tmpstr(strlen+1:64)    = repeat(char(0), 64-strlen)
553         iost    = nf90\_put\_var(ncid, st\_var\_id, tmpstr, (/ 1, ii /), (/ 64, 1 /))
554         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
555 \textcolor{keywordflow}{    END DO}
556 
557     \textcolor{comment}{!}
558     \textcolor{comment}{! Write the pressure levels.}
559     \textcolor{comment}{!}
560     iost    = nf90\_put\_var(ncid, p\_var\_id, p)
561     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
562 
563     \textcolor{comment}{!}
564     \textcolor{comment}{! Write the time steps.}
565     \textcolor{comment}{!}
566     iost    = nf90\_put\_var(ncid, t\_var\_id, t)
567     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
568 
569     \textcolor{comment}{!}
570     \textcolor{comment}{! Write the data arrays.}
571     \textcolor{comment}{!}
572     iost    = nf90\_put\_var(ncid, du\_var\_id, du)
573     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
574 
575     iost    = nf90\_put\_var(ncid, ds\_var\_id, ds)
576     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
577 
578     iost    = nf90\_put\_var(ncid, boundary\_var\_id, boundary)
579     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
580 
581     iost    = nf90\_put\_var(ncid, stru\_var\_id, stru)
582     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
583 
584     iost    = nf90\_put\_var(ncid, strs\_var\_id, strs)
585     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
586 
587     iost    = nf90\_put\_var(ncid, weight\_var\_id, weight)
588     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
589 
590     \textcolor{comment}{!}
591     \textcolor{comment}{! Close the NetCDF file.}
592     \textcolor{comment}{!}
593     iost    = nf90\_close(ncid)
594     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
595 
596     \textcolor{comment}{!}
597     \textcolor{comment}{! Catch any NetCDF errors here.}
598     \textcolor{comment}{!}
599     9999 \textcolor{keywordflow}{CONTINUE}
600     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
601         print *,\textcolor{stringliteral}{'E: Problem creating NetCDF file '},outputfile
602         print *, trim(nf90\_strerror(iost))
603         stop \textcolor{stringliteral}{'1'}
604 \textcolor{keywordflow}{    END IF}
605 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=310pt]{namespaceio_a63d1618c60598d1e5ac65348efb74bdc_icgraph}
\end{center}
\end{figure}


\index{io@{io}!opt\+\_\+budget\+\_\+netcdf@{opt\+\_\+budget\+\_\+netcdf}}
\index{opt\+\_\+budget\+\_\+netcdf@{opt\+\_\+budget\+\_\+netcdf}!io@{io}}
\subsubsection[{\texorpdfstring{opt\+\_\+budget\+\_\+netcdf(\+O\+U\+T\+P\+U\+T\+F\+I\+L\+E, B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+M\+N, B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+E\+R, V\+B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+M\+N, V\+B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+E\+R, A\+V\+E\+\_\+\+Q\+S, A\+V\+E\+\_\+\+S\+S, P, T)}{opt_budget_netcdf(OUTPUTFILE, BUDGET_COLUMN, BUDGET_LAYER, VBUDGET_COLUMN, VBUDGET_LAYER, AVE_QS, AVE_SS, P, T)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::opt\+\_\+budget\+\_\+netcdf (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{O\+U\+T\+P\+U\+T\+F\+I\+LE, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:), intent(in)}]{B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+MN, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:,\+:), intent(in)}]{B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+ER, }
\item[{character (len=64), dimension(\+:,\+:), intent(in)}]{V\+B\+U\+D\+G\+E\+T\+\_\+\+C\+O\+L\+U\+MN, }
\item[{character (len=64), dimension(\+:,\+:), intent(in)}]{V\+B\+U\+D\+G\+E\+T\+\_\+\+L\+A\+Y\+ER, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{A\+V\+E\+\_\+\+QS, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{A\+V\+E\+\_\+\+SS, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{P, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{T}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_ab1a423779bddf2d4557f39dd81431d93}{}\label{namespaceio_ab1a423779bddf2d4557f39dd81431d93}


Definition at line 893 of file io.\+f90.


\begin{DoxyCode}
893     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
894     \textcolor{keywordtype}{USE }netcdf
895 
896     \textcolor{keywordtype}{IMPLICIT NONE}
897 
898     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: outputfile       \textcolor{comment}{! Name of the
       output file.}
899     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:)}, \textcolor{keywordtype}{INTENT(IN)}                       :: budget\_column
900     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:,:)}, \textcolor{keywordtype}{INTENT(IN)}                     :: budget\_layer
901     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)}                      :: vbudget\_column
902     \textcolor{keywordtype}{CHARACTER (LEN=64)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)}                      :: vbudget\_layer
903     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: ave\_qs
904     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: ave\_ss
905     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: p
906     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: t
907 
908     \textcolor{comment}{!}
909     \textcolor{comment}{! Local variables.}
910     \textcolor{comment}{!}
911     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ncid                                                 \textcolor{comment}{! ID of NetCDF
       file.}
912     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: bcv\_dim\_id, bct\_dim\_id, blv\_dim\_id, blt\_dim\_id, p\_dim\_id, t\_dim\_id, 
      str\_dim\_id
913     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: bc\_var\_id, bl\_var\_id, vbc\_var\_id, vbl\_var\_id, ave\_qs\_var\_id, 
      ave\_ss\_var\_id, p\_var\_id, t\_var\_id
914     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: iost                                                 \textcolor{comment}{! I/O status.}
915     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ii, jj                                               \textcolor{comment}{! Counter.}
916     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: strlen                                               \textcolor{comment}{! String length.}
917     \textcolor{keywordtype}{CHARACTER (LEN=64)}          :: tmpstr                                               \textcolor{comment}{! Temporary string.}
918 
919     \textcolor{comment}{!}
920     \textcolor{comment}{! Create the NetCDF file.}
921     \textcolor{comment}{!}
922     iost    = nf90\_noerr
923     iost    = nf90\_create(outputfile, nf90\_noclobber, ncid)
924     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
925 
926     \textcolor{comment}{!}
927     \textcolor{comment}{! Define the dimensions.}
928     \textcolor{comment}{!}
929     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"bcv"}, \textcolor{keyword}{SIZE}(budget\_column, dim=1), bcv\_dim\_id)
930     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
931 
932     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"bct"}, \textcolor{keyword}{SIZE}(budget\_column, dim=2), bct\_dim\_id)
933     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
934 
935     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"blv"}, \textcolor{keyword}{SIZE}(budget\_layer, dim=1), blv\_dim\_id)
936     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
937 
938     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"blt"}, \textcolor{keyword}{SIZE}(budget\_layer, dim=2), blt\_dim\_id)
939     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
940 
941     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"levels"}, \textcolor{keyword}{SIZE}(p, dim=1), p\_dim\_id)
942     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
943 
944     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"time"}, \textcolor{keyword}{SIZE}(t, dim=1), t\_dim\_id)
945     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
946 
947     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"string"}, 64, str\_dim\_id)                  \textcolor{comment}{! This dimension is used for
       character strings.}
948     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
949 
950     \textcolor{comment}{!}
951     \textcolor{comment}{! Define the variables.}
952     \textcolor{comment}{!}
953     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"budget\_column"}, nf90\_double, (/ bcv\_dim\_id, bct\_dim\_id, t\_dim\_id /), 
      bc\_var\_id)
954     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
955 
956     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"budget\_layer"}, nf90\_double, (/ blv\_dim\_id, blt\_dim\_id, p\_dim\_id, t\_dim\_id
       /), bl\_var\_id)
957     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
958 
959     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"vbudget\_column"}, nf90\_char, (/ str\_dim\_id, bcv\_dim\_id, bct\_dim\_id /), 
      vbc\_var\_id)
960     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
961 
962     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"vbudget\_layer"}, nf90\_char, (/ str\_dim\_id, blv\_dim\_id, blt\_dim\_id /), 
      vbl\_var\_id)
963     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
964 
965     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"ave\_qs"}, nf90\_double, (/ t\_dim\_id /), ave\_qs\_var\_id)
966     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
967 
968     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"ave\_ss"}, nf90\_double, (/ t\_dim\_id /), ave\_ss\_var\_id)
969     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
970 
971     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"levels"}, nf90\_double, (/ p\_dim\_id /), p\_var\_id)
972     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
973 
974     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"time"}, nf90\_double, (/ t\_dim\_id /), t\_var\_id)
975     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
976 
977     \textcolor{comment}{!}
978     \textcolor{comment}{! Create various attributes. Make sure strings are null terminated (for C programs).}
979     \textcolor{comment}{!}
980     iost    = nf90\_put\_att(ncid, t\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'Days since 2004-10-01T00:00:00 UTC'}//char(0))
981     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
982     iost    = nf90\_put\_att(ncid, p\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'hPa'}//char(0))
983     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
984 
985     \textcolor{comment}{!}
986     \textcolor{comment}{! We've finished defining stuff, leave the definition mode.}
987     \textcolor{comment}{!}
988     iost    = nf90\_enddef(ncid)
989     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
990 
991     \textcolor{comment}{!}
992     \textcolor{comment}{! Write VBUDGET\_COLUMN and VBUDGET\_LAYER. Terminate strings with a null byte, in case the data are
       subsequently }
993     \textcolor{comment}{! read by a C program.}
994     \textcolor{comment}{!}
995     \textcolor{keywordflow}{DO} ii=1,\textcolor{keyword}{SIZE}(budget\_column, dim=1)
996         \textcolor{keywordflow}{DO} jj=1,\textcolor{keyword}{SIZE}(budget\_column, dim=2)
997             tmpstr      = trim(vbudget\_column(ii,jj))
998             strlen      = min(63, len\_trim(tmpstr))         \textcolor{comment}{! The characters after this positon will be
       replaced by null characters.}
999             tmpstr(strlen+1:64)    = repeat(char(0), 64-strlen)
1000             iost        = nf90\_put\_var(ncid, vbc\_var\_id, tmpstr, (/ 1, ii, jj /), (/ 64, 1, 1 /))
1001             \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1002 \textcolor{keywordflow}{        END DO}
1003 \textcolor{keywordflow}{    END DO}
1004 
1005     \textcolor{keywordflow}{DO} ii=1,\textcolor{keyword}{SIZE}(budget\_layer, dim=1)
1006         \textcolor{keywordflow}{DO} jj=1,\textcolor{keyword}{SIZE}(budget\_layer, dim=2)
1007             tmpstr      = trim(vbudget\_layer(ii,jj))
1008             strlen      = min(63, len\_trim(tmpstr))         \textcolor{comment}{! The characters after this positon will be
       replaced by null characters.}
1009             tmpstr(strlen+1:64)    = repeat(char(0), 64-strlen)
1010             iost        = nf90\_put\_var(ncid, vbl\_var\_id, tmpstr, (/ 1, ii, jj /), (/ 64, 1, 1 /))
1011             \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1012 \textcolor{keywordflow}{        END DO}
1013 \textcolor{keywordflow}{    END DO}
1014 
1015     \textcolor{comment}{!}
1016     \textcolor{comment}{! Write the pressure levels.}
1017     \textcolor{comment}{!}
1018     iost    = nf90\_put\_var(ncid, p\_var\_id, p)
1019     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1020 
1021     \textcolor{comment}{!}
1022     \textcolor{comment}{! Write the time steps.}
1023     \textcolor{comment}{!}
1024     iost    = nf90\_put\_var(ncid, t\_var\_id, t)
1025     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1026 
1027     \textcolor{comment}{!}
1028     \textcolor{comment}{! Write the data arrays.}
1029     \textcolor{comment}{!}
1030     iost    = nf90\_put\_var(ncid, bc\_var\_id, budget\_column)
1031     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1032 
1033     iost    = nf90\_put\_var(ncid, bl\_var\_id, budget\_layer)
1034     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1035 
1036     iost    = nf90\_put\_var(ncid, ave\_qs\_var\_id, ave\_qs)
1037     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1038 
1039     iost    = nf90\_put\_var(ncid, ave\_ss\_var\_id, ave\_ss)
1040     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1041 
1042     \textcolor{comment}{!}
1043     \textcolor{comment}{! Close the NetCDF file.}
1044     \textcolor{comment}{!}
1045     iost    = nf90\_close(ncid)
1046     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1047 
1048     \textcolor{comment}{!}
1049     \textcolor{comment}{! Catch any NetCDF errors here.}
1050     \textcolor{comment}{!}
1051     9999 \textcolor{keywordflow}{CONTINUE}
1052     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
1053         print *,\textcolor{stringliteral}{'E: Problem creating NetCDF file '},outputfile
1054         print *, trim(nf90\_strerror(iost))
1055         stop \textcolor{stringliteral}{'1'}
1056 \textcolor{keywordflow}{    END IF}
1057 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{namespaceio_ab1a423779bddf2d4557f39dd81431d93_icgraph}
\end{center}
\end{figure}


\index{io@{io}!opt\+\_\+forcing\+\_\+netcdf@{opt\+\_\+forcing\+\_\+netcdf}}
\index{opt\+\_\+forcing\+\_\+netcdf@{opt\+\_\+forcing\+\_\+netcdf}!io@{io}}
\subsubsection[{\texorpdfstring{opt\+\_\+forcing\+\_\+netcdf(\+O\+U\+T\+P\+U\+T\+F\+I\+L\+E, S\+F\+C\+\_\+\+D\+A\+T\+A, M\+L\+\_\+\+D\+A\+T\+A, C\+F\+\_\+\+L\+O\+N, C\+F\+\_\+\+L\+A\+T, C\+F\+\_\+\+P\+H\+I\+S, P\+L\+E\+V\+S)}{opt_forcing_netcdf(OUTPUTFILE, SFC_DATA, ML_DATA, CF_LON, CF_LAT, CF_PHIS, PLEVS)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::opt\+\_\+forcing\+\_\+netcdf (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{O\+U\+T\+P\+U\+T\+F\+I\+LE, }
\item[{real (kind=rk8), dimension(\+:,\+:), intent(in)}]{S\+F\+C\+\_\+\+D\+A\+TA, }
\item[{real (kind=rk8), dimension(\+:,\+:,\+:), intent(in)}]{M\+L\+\_\+\+D\+A\+TA, }
\item[{real (kind=rk4), intent(in)}]{C\+F\+\_\+\+L\+ON, }
\item[{real (kind=rk4), intent(in)}]{C\+F\+\_\+\+L\+AT, }
\item[{real (kind=rk4), intent(in)}]{C\+F\+\_\+\+P\+H\+IS, }
\item[{real (kind=rk8), dimension(\+:), intent(in)}]{P\+L\+E\+VS}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_a50ab1073758d8d341087a0755354011d}{}\label{namespaceio_a50ab1073758d8d341087a0755354011d}


Definition at line 1708 of file io.\+f90.


\begin{DoxyCode}
1708     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
1709     \textcolor{keywordtype}{USE }netcdf
1710     \textcolor{keywordtype}{USE }\hyperlink{namespacetime}{time}
1711 
1712     \textcolor{keywordtype}{IMPLICIT NONE}
1713 
1714     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: outputfile       \textcolor{comment}{! Name of the
       output file.}
1715     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{INTENT(IN)}                         :: sfc\_data         \textcolor{comment}{! Surface
       forcing data.}
1716     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:,:,:)}, \textcolor{keywordtype}{INTENT(IN)}                       :: ml\_data          \textcolor{comment}{! Multi-levcel
       forcing data.}
1717     \textcolor{keywordtype}{REAL (KIND=RK4)}, \textcolor{keywordtype}{INTENT(IN)}                                         :: cf\_lon           \textcolor{comment}{! Central
       facility longitude.}
1718     \textcolor{keywordtype}{REAL (KIND=RK4)}, \textcolor{keywordtype}{INTENT(IN)}                                         :: cf\_lat           \textcolor{comment}{! Central
       facility latitude.}
1719     \textcolor{keywordtype}{REAL (KIND=RK4)}, \textcolor{keywordtype}{INTENT(IN)}                                         :: cf\_phis          \textcolor{comment}{! Central
       facility geopotential height.}
1720     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)}                           :: plevs            \textcolor{comment}{! Pressure
       levels in analysis.}
1721 
1722     \textcolor{comment}{!}
1723     \textcolor{comment}{! Local variables.}
1724     \textcolor{comment}{!}
1725     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: ncid                                                 \textcolor{comment}{! ID of
       NetCDF file.}
1726     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: time\_dim\_id, lev\_dim\_id                              \textcolor{comment}{! Dimension
       IDs.}
1727     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: base\_time\_var\_id                                     \textcolor{comment}{! Variable
       ID for base\_time}
1728     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: time\_var\_id
1729     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: time\_offset\_var\_id
1730     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: year\_var\_id
1731     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: month\_var\_id
1732     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: day\_var\_id
1733     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: hour\_var\_id
1734     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: minute\_var\_id
1735     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: lat\_var\_id
1736     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: lon\_var\_id
1737     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: phis\_var\_id
1738     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: lev\_var\_id
1739     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: temp\_var\_id
1740     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: q\_var\_id
1741     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: u\_var\_id
1742     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: v\_var\_id
1743     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: omega\_var\_id
1744     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: div\_var\_id
1745     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: tadvh\_var\_id
1746     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: tadvv\_var\_id
1747     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: qadvh\_var\_id
1748     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: qadvv\_var\_id
1749     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: s\_var\_id
1750     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: sadvh\_var\_id
1751     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: sadvv\_var\_id
1752     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: dsdt\_var\_id
1753     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: dtdt\_var\_id
1754     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: dqdt\_var\_id
1755     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: q1\_var\_id
1756     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: q2\_var\_id
1757     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: cld\_var\_id
1758     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: prec\_var\_id
1759     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: lh\_var\_id
1760     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: sh\_var\_id
1761     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: psa\_var\_id
1762     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: psi\_var\_id
1763     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: tsair\_var\_id
1764     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: tskin\_var\_id
1765     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: rhair\_var\_id
1766     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: wspd\_var\_id
1767     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: us\_var\_id
1768     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: vs\_var\_id
1769     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: srfrad\_var\_id
1770     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: flut\_var\_id
1771     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: fsnt\_var\_id
1772     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: solin\_var\_id
1773     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: cldlow\_var\_id
1774     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: cldmed\_var\_id
1775     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: cldhgh\_var\_id
1776     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: cldtot\_var\_id
1777     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: cldthk\_var\_id
1778     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: cldtop\_var\_id
1779     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: lwp\_var\_id
1780     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: cdh2odt\_var\_id
1781     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: ch2oadv\_var\_id
1782     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: evap\_var\_id
1783     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: cdsdt\_var\_id
1784     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: csadv\_var\_id
1785     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: crad\_var\_id
1786     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: clh\_var\_id
1787     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: omegas\_var\_id
1788     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: qs\_var\_id
1789     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: s2m\_var\_id
1790     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: pw\_var\_id
1791     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: flus\_var\_id
1792     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: flds\_var\_id
1793     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: fsus\_var\_id
1794     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: fsds\_var\_id
1795 
1796     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: nt                                                   \textcolor{comment}{! Number of
       time steps.}
1797     \textcolor{keywordtype}{INTEGER (KIND=IK4)}                  :: iost                                                 \textcolor{comment}{! I/O
       status.}
1798     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{DIMENSION(8)}    :: date\_time                                            \textcolor{comment}{! Holds
       date and time components.}
1799     \textcolor{keywordtype}{CHARACTER (LEN=64)}                  :: tmpstr                                               \textcolor{comment}{! Temporary
       string.}
1800 
1801     \textcolor{comment}{!}
1802     \textcolor{comment}{! Create the NetCDF file.}
1803     \textcolor{comment}{!}
1804     iost    = nf90\_noerr
1805     iost    = nf90\_create(outputfile, nf90\_noclobber, ncid)
1806     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1807 
1808     \textcolor{comment}{!}
1809     \textcolor{comment}{! Define the dimensions.}
1810     \textcolor{comment}{!}
1811     nt      = \textcolor{keyword}{SIZE}(sfc\_data, dim=2)                                                             \textcolor{comment}{! Number of
       time steps.}
1812     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"time"}, nt, time\_dim\_id)                                     \textcolor{comment}{! Don't
       output first and last times.}
1813     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1814 
1815     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"lev"}, \textcolor{keyword}{SIZE}(ml\_data, dim=2), lev\_dim\_id)
1816     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1817 
1818     \textcolor{comment}{!}
1819     \textcolor{comment}{! Define the variables and attributes. Make sure that strings are null terminated (to be nice to C
       programs).}
1820     \textcolor{comment}{!}
1821     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"base\_time"}, nf90\_double, base\_time\_var\_id)
1822     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1823     iost    = nf90\_put\_att(ncid, base\_time\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Base time in Epoch'}//char(0))
1824     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1825     iost    = nf90\_put\_att(ncid, base\_time\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'seconds since 1970-01-01T00:00:00Z'}//char(0))
1826     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1827     \textcolor{keyword}{WRITE}(unit=tmpstr, fmt=\textcolor{stringliteral}{'(I4.4,"-",I2.2,"-",I2.2,"T",I2.2,":",I2.2,":",I2.2,"Z")'}) &
1828         & int(sfc\_data(2,1)),int(sfc\_data(3,1)),int(sfc\_data(4,1)),int(sfc\_data(5,1)),int(sfc\_data(6,1)),0
1829     iost    = nf90\_put\_att(ncid, base\_time\_var\_id, \textcolor{stringliteral}{"string"}, tmpstr//char(0))
1830     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1831 
1832     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"time"}, nf90\_double, (/ time\_dim\_id /), time\_var\_id)
1833     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1834     \textcolor{keyword}{WRITE}(unit=tmpstr, fmt=\textcolor{stringliteral}{'(I4.4)'}) int(sfc\_data(2,1))
1835     iost    = nf90\_put\_att(ncid, time\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Calendar day fraction of the year '}//tmpstr//
      char(0))
1836     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1837     \textcolor{keyword}{WRITE}(unit=tmpstr, fmt=\textcolor{stringliteral}{'(I4.4,"-12-31")'}) int(sfc\_data(2,1)-1)
1838     iost    = nf90\_put\_att(ncid, time\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'days since '}//tmpstr//char(0))
1839     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1840 \textcolor{comment}{!    IOST    = NF90\_PUT\_ATT(NCID, TIME\_VAR\_ID, "calendar", 'proleptic\_gregorian'//CHAR(0))}
1841 \textcolor{comment}{!    IF (IOST .NE. NF90\_NOERR) GO TO 9999}
1842     iost    = nf90\_put\_att(ncid, time\_var\_id, \textcolor{stringliteral}{"axis"}, \textcolor{stringliteral}{'T'}//char(0))
1843     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1844 
1845     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"time\_offset"}, nf90\_double, (/ time\_dim\_id /), time\_offset\_var\_id)
1846     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1847     iost    = nf90\_put\_att(ncid, time\_offset\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Time offset from base\_time'}//char(0))
1848     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1849     \textcolor{keyword}{WRITE}(unit=tmpstr, fmt=\textcolor{stringliteral}{'(I4.4,"-",I2.2,"-",I2.2,"T",I2.2,":",I2.2,":",I2.2,"Z")'}) &
1850         & int(sfc\_data(2,1)),int(sfc\_data(3,1)),int(sfc\_data(4,1)),int(sfc\_data(5,1)),int(sfc\_data(6,1)),0
1851     iost    = nf90\_put\_att(ncid, time\_offset\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'seconds since '}//tmpstr//char(0))
1852     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1853 
1854     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"year"}, nf90\_int, (/ time\_dim\_id /), year\_var\_id)
1855     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1856     iost    = nf90\_put\_att(ncid, year\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Year'}//char(0))
1857     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1858     iost    = nf90\_put\_att(ncid, year\_var\_id, \textcolor{stringliteral}{"units"}, char(0))
1859     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1860     iost    = nf90\_put\_att(ncid, year\_var\_id, \textcolor{stringliteral}{"missing\_value"}, int(-9999, kind=
      \hyperlink{namespaceportable_aa110cf333432508140602ea192c4b2ea}{ik4}))
1861     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1862 
1863     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"month"}, nf90\_int, (/ time\_dim\_id /), month\_var\_id)
1864     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1865     iost    = nf90\_put\_att(ncid, month\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Month'}//char(0))
1866     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1867     iost    = nf90\_put\_att(ncid, month\_var\_id, \textcolor{stringliteral}{"units"}, char(0))
1868     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1869     iost    = nf90\_put\_att(ncid, month\_var\_id, \textcolor{stringliteral}{"missing\_value"}, int(-9999, kind=
      \hyperlink{namespaceportable_aa110cf333432508140602ea192c4b2ea}{ik4}))
1870     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1871 
1872     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"day"}, nf90\_int, (/ time\_dim\_id /), day\_var\_id)
1873     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1874     iost    = nf90\_put\_att(ncid, day\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Day'}//char(0))
1875     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1876     iost    = nf90\_put\_att(ncid, day\_var\_id, \textcolor{stringliteral}{"units"}, char(0))
1877     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1878     iost    = nf90\_put\_att(ncid, day\_var\_id, \textcolor{stringliteral}{"missing\_value"}, int(-9999, kind=
      \hyperlink{namespaceportable_aa110cf333432508140602ea192c4b2ea}{ik4}))
1879     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1880 
1881     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"hour"}, nf90\_int, (/ time\_dim\_id /), hour\_var\_id)
1882     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1883     iost    = nf90\_put\_att(ncid, hour\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Hour'}//char(0))
1884     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1885     iost    = nf90\_put\_att(ncid, hour\_var\_id, \textcolor{stringliteral}{"units"}, char(0))
1886     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1887     iost    = nf90\_put\_att(ncid, hour\_var\_id, \textcolor{stringliteral}{"missing\_value"}, int(-9999, kind=
      \hyperlink{namespaceportable_aa110cf333432508140602ea192c4b2ea}{ik4}))
1888     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1889 
1890     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"minute"}, nf90\_int, (/ time\_dim\_id /), minute\_var\_id)
1891     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1892     iost    = nf90\_put\_att(ncid, minute\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Minute'}//char(0))
1893     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1894     iost    = nf90\_put\_att(ncid, minute\_var\_id, \textcolor{stringliteral}{"units"}, char(0))
1895     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1896     iost    = nf90\_put\_att(ncid, minute\_var\_id, \textcolor{stringliteral}{"missing\_value"}, int(-9999, kind=
      \hyperlink{namespaceportable_aa110cf333432508140602ea192c4b2ea}{ik4}))
1897     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1898 
1899     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"lat"}, nf90\_float, lat\_var\_id)
1900     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1901     iost    = nf90\_put\_att(ncid, lat\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'latitude'}//char(0))
1902     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1903     iost    = nf90\_put\_att(ncid, lat\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'degrees North'}//char(0))
1904     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1905     iost    = nf90\_put\_att(ncid, lat\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
1906     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1907 
1908     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"lon"}, nf90\_float, lon\_var\_id)
1909     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1910     iost    = nf90\_put\_att(ncid, lon\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'longitude'}//char(0))
1911     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1912     iost    = nf90\_put\_att(ncid, lon\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'degrees East'}//char(0))
1913     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1914     iost    = nf90\_put\_att(ncid, lon\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
1915     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1916 
1917     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"phis"}, nf90\_float, phis\_var\_id)
1918     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1919     iost    = nf90\_put\_att(ncid, phis\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'surface geopotential height'}//char(0))
1920     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1921     iost    = nf90\_put\_att(ncid, phis\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'m^2/s^2'}//char(0))
1922     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1923     iost    = nf90\_put\_att(ncid, phis\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
1924     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1925 
1926     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"lev"}, nf90\_double, (/ lev\_dim\_id /), lev\_var\_id)
1927     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1928     iost    = nf90\_put\_att(ncid, lev\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'pressure levels'}//char(0))
1929     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1930     iost    = nf90\_put\_att(ncid, lev\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'hPa'}//char(0))
1931     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1932     iost    = nf90\_put\_att(ncid, lev\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_a609d4b38b4f128b310e288b1861ad9bd}{rk8}))
1933     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1934 
1935     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"T"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), temp\_var\_id)
1936     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1937     iost    = nf90\_put\_att(ncid, temp\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Temperature'}//char(0))
1938     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1939     iost    = nf90\_put\_att(ncid, temp\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K'}//char(0))
1940     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1941     iost    = nf90\_put\_att(ncid, temp\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
1942     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1943 
1944     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"q"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), q\_var\_id)
1945     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1946     iost    = nf90\_put\_att(ncid, q\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Water vapour mixing ratio'}//char(0))
1947     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1948     iost    = nf90\_put\_att(ncid, q\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'g/kg'}//char(0))
1949     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1950     iost    = nf90\_put\_att(ncid, q\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=\hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
1951     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1952 
1953     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"u"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), u\_var\_id)
1954     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1955     iost    = nf90\_put\_att(ncid, u\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Horizontal wind U component'}//char(0))
1956     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1957     iost    = nf90\_put\_att(ncid, u\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'m/s'}//char(0))
1958     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1959     iost    = nf90\_put\_att(ncid, u\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=\hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
1960     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1961 
1962     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"v"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), v\_var\_id)
1963     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1964     iost    = nf90\_put\_att(ncid, v\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Horizontal wind V component'}//char(0))
1965     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1966     iost    = nf90\_put\_att(ncid, v\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'m/s'}//char(0))
1967     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1968     iost    = nf90\_put\_att(ncid, v\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=\hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
1969     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1970 
1971     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"omega"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), omega\_var\_id)
1972     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1973     iost    = nf90\_put\_att(ncid, omega\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'vertical velocity'}//char(0))
1974     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1975     iost    = nf90\_put\_att(ncid, omega\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'hPa/hour'}//char(0))
1976     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1977     iost    = nf90\_put\_att(ncid, omega\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
1978     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1979 
1980     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"div"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), div\_var\_id)
1981     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1982     iost    = nf90\_put\_att(ncid, div\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Horizontal wind divergence'}//char(0))
1983     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1984     iost    = nf90\_put\_att(ncid, div\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'1/s'}//char(0))
1985     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1986     iost    = nf90\_put\_att(ncid, div\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
1987     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1988 
1989     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"T\_adv\_h"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), tadvh\_var\_id)
1990     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1991     iost    = nf90\_put\_att(ncid, tadvh\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Horizontal temperature Advection'}//char(0))
1992     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1993     iost    = nf90\_put\_att(ncid, tadvh\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/hour'}//char(0))
1994     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1995     iost    = nf90\_put\_att(ncid, tadvh\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
1996     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
1997 
1998     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"T\_adv\_v"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), tadvv\_var\_id)
1999     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2000     iost    = nf90\_put\_att(ncid, tadvv\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Vertical temperature Advection'}//char(0))
2001     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2002     iost    = nf90\_put\_att(ncid, tadvv\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/hour'}//char(0))
2003     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2004     iost    = nf90\_put\_att(ncid, tadvv\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2005     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2006 
2007     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"q\_adv\_h"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), qadvh\_var\_id)
2008     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2009     iost    = nf90\_put\_att(ncid, qadvh\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Horizontal q advection'}//char(0))
2010     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2011     iost    = nf90\_put\_att(ncid, qadvh\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'g/kg/hour'}//char(0))
2012     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2013     iost    = nf90\_put\_att(ncid, qadvh\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2014     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2015 
2016     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"q\_adv\_v"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), qadvv\_var\_id)
2017     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2018     iost    = nf90\_put\_att(ncid, qadvv\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Vertical q advection'}//char(0))
2019     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2020     iost    = nf90\_put\_att(ncid, qadvv\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'g/kg/hour'}//char(0))
2021     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2022     iost    = nf90\_put\_att(ncid, qadvv\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2023     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2024 
2025     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"s"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), s\_var\_id)
2026     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2027     iost    = nf90\_put\_att(ncid, s\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Dry static energy'}//char(0))
2028     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2029     iost    = nf90\_put\_att(ncid, s\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K'}//char(0))
2030     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2031     iost    = nf90\_put\_att(ncid, s\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=\hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2032     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2033 
2034     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"s\_adv\_h"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), sadvh\_var\_id)
2035     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2036     iost    = nf90\_put\_att(ncid, sadvh\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Horizontal dry static energy advection'}//char(
      0))
2037     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2038     iost    = nf90\_put\_att(ncid, sadvh\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/hour'}//char(0))
2039     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2040     iost    = nf90\_put\_att(ncid, sadvh\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2041     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2042 
2043     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"s\_adv\_v"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), sadvv\_var\_id)
2044     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2045     iost    = nf90\_put\_att(ncid, sadvv\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Vertical dry static energy advection'}//char(0)
      )
2046     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2047     iost    = nf90\_put\_att(ncid, sadvv\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/hour'}//char(0))
2048     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2049     iost    = nf90\_put\_att(ncid, sadvv\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2050     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2051 
2052     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"dsdt"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), dsdt\_var\_id)
2053     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2054     iost    = nf90\_put\_att(ncid, dsdt\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'d(dry static energy)/dt'}//char(0))
2055     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2056     iost    = nf90\_put\_att(ncid, dsdt\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/hour'}//char(0))
2057     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2058     iost    = nf90\_put\_att(ncid, dsdt\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2059     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2060 
2061     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"dTdt"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), dtdt\_var\_id)
2062     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2063     iost    = nf90\_put\_att(ncid, dtdt\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'d(temperature)/dt'}//char(0))
2064     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2065     iost    = nf90\_put\_att(ncid, dtdt\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/hour'}//char(0))
2066     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2067     iost    = nf90\_put\_att(ncid, dtdt\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2068     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2069 
2070     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"dqdt"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), dqdt\_var\_id)
2071     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2072     iost    = nf90\_put\_att(ncid, dqdt\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'d(water vapour mixing ratio)/dt'}//char(0))
2073     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2074     iost    = nf90\_put\_att(ncid, dqdt\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'g/kg/hour'}//char(0))
2075     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2076     iost    = nf90\_put\_att(ncid, dqdt\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2077     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2078 
2079     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"q1"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), q1\_var\_id)
2080     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2081     iost    = nf90\_put\_att(ncid, q1\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Apparent heat sources Yanai (1973)'}//char(0))
2082     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2083     iost    = nf90\_put\_att(ncid, q1\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/hour'}//char(0))
2084     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2085     iost    = nf90\_put\_att(ncid, q1\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2086     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2087 
2088     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"q2"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), q2\_var\_id)
2089     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2090     iost    = nf90\_put\_att(ncid, q2\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Apparent moisture sinks Yanai (1973)'}//char(0))
2091     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2092     iost    = nf90\_put\_att(ncid, q2\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K/hour'}//char(0))
2093     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2094     iost    = nf90\_put\_att(ncid, q2\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2095     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2096 
2097     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"cld"}, nf90\_float, (/ lev\_dim\_id, time\_dim\_id /), cld\_var\_id)
2098     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2099     iost    = nf90\_put\_att(ncid, cld\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Cloud fraction'}//char(0))
2100     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2101     iost    = nf90\_put\_att(ncid, cld\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'%'}//char(0))
2102     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2103     iost    = nf90\_put\_att(ncid, cld\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2104     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2105 
2106     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"prec\_srf"}, nf90\_float, (/ time\_dim\_id /), prec\_var\_id)
2107     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2108     iost    = nf90\_put\_att(ncid, prec\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface precipitation'}//char(0))
2109     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2110     iost    = nf90\_put\_att(ncid, prec\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'mm/hour'}//char(0))
2111     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2112     iost    = nf90\_put\_att(ncid, prec\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2113     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2114 
2115     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"LH"}, nf90\_float, (/ time\_dim\_id /), lh\_var\_id)
2116     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2117     iost    = nf90\_put\_att(ncid, lh\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface latent heat flux, upward positive'}//char(
      0))
2118     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2119     iost    = nf90\_put\_att(ncid, lh\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2120     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2121     iost    = nf90\_put\_att(ncid, lh\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2122     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2123 
2124     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"SH"}, nf90\_float, (/ time\_dim\_id /), sh\_var\_id)
2125     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2126     iost    = nf90\_put\_att(ncid, sh\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface sensible heat flux, upward positive'}//
      char(0))
2127     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2128     iost    = nf90\_put\_att(ncid, sh\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2129     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2130     iost    = nf90\_put\_att(ncid, sh\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2131     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2132 
2133     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"p\_srf\_aver"}, nf90\_float, (/ time\_dim\_id /), psa\_var\_id)
2134     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2135     iost    = nf90\_put\_att(ncid, psa\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface pressure averaged over the domain'}//char
      (0))
2136     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2137     iost    = nf90\_put\_att(ncid, psa\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'hPa'}//char(0))
2138     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2139     iost    = nf90\_put\_att(ncid, psa\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2140     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2141 
2142     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"p\_srf\_center"}, nf90\_float, (/ time\_dim\_id /), psi\_var\_id)
2143     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2144     iost    = nf90\_put\_att(ncid, psi\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface pressure at centre of the domain'}//char(
      0))
2145     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2146     iost    = nf90\_put\_att(ncid, psi\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'hPa'}//char(0))
2147     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2148     iost    = nf90\_put\_att(ncid, psi\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2149     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2150 
2151     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"T\_srf"}, nf90\_float, (/ time\_dim\_id /), tsair\_var\_id)
2152     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2153     iost    = nf90\_put\_att(ncid, tsair\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'2m air temperature'}//char(0))
2154     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2155     iost    = nf90\_put\_att(ncid, tsair\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'Celsius'}//char(0))
2156     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2157     iost    = nf90\_put\_att(ncid, tsair\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2158     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2159 
2160     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"T\_skin"}, nf90\_float, (/ time\_dim\_id /), tskin\_var\_id)
2161     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2162     iost    = nf90\_put\_att(ncid, tskin\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface skin temperature'}//char(0))
2163     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2164     iost    = nf90\_put\_att(ncid, tskin\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'Celsius'}//char(0))
2165     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2166     iost    = nf90\_put\_att(ncid, tskin\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2167     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2168 
2169     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"RH\_srf"}, nf90\_float, (/ time\_dim\_id /), rhair\_var\_id)
2170     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2171     iost    = nf90\_put\_att(ncid, rhair\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'2m air relative humidity'}//char(0))
2172     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2173     iost    = nf90\_put\_att(ncid, rhair\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'%'}//char(0))
2174     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2175     iost    = nf90\_put\_att(ncid, rhair\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2176     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2177 
2178     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"wspd\_srf"}, nf90\_float, (/ time\_dim\_id /), wspd\_var\_id)
2179     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2180     iost    = nf90\_put\_att(ncid, wspd\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'10m wind speed'}//char(0))
2181     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2182     iost    = nf90\_put\_att(ncid, wspd\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'m/s'}//char(0))
2183     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2184     iost    = nf90\_put\_att(ncid, wspd\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2185     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2186 
2187     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"u\_srf"}, nf90\_float, (/ time\_dim\_id /), us\_var\_id)
2188     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2189     iost    = nf90\_put\_att(ncid, us\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'10m U component'}//char(0))
2190     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2191     iost    = nf90\_put\_att(ncid, us\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'m/s'}//char(0))
2192     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2193     iost    = nf90\_put\_att(ncid, us\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2194     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2195 
2196     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"v\_srf"}, nf90\_float, (/ time\_dim\_id /), vs\_var\_id)
2197     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2198     iost    = nf90\_put\_att(ncid, vs\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'10m V component'}//char(0))
2199     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2200     iost    = nf90\_put\_att(ncid, vs\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'m/s'}//char(0))
2201     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2202     iost    = nf90\_put\_att(ncid, vs\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2203     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2204 
2205     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"rad\_net\_srf"}, nf90\_float, (/ time\_dim\_id /), srfrad\_var\_id)
2206     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2207     iost    = nf90\_put\_att(ncid, srfrad\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface net radiation, downward positive'}//
      char(0))
2208     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2209     iost    = nf90\_put\_att(ncid, srfrad\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2210     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2211     iost    = nf90\_put\_att(ncid, srfrad\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2212     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2213 
2214     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"lw\_net\_toa"}, nf90\_float, (/ time\_dim\_id /), flut\_var\_id)
2215     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2216     iost    = nf90\_put\_att(ncid, flut\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'TOA LW flux, upward positive'}//char(0))
2217     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2218     iost    = nf90\_put\_att(ncid, flut\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2219     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2220     iost    = nf90\_put\_att(ncid, flut\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2221     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2222 
2223     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"sw\_net\_toa"}, nf90\_float, (/ time\_dim\_id /), fsnt\_var\_id)
2224     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2225     iost    = nf90\_put\_att(ncid, fsnt\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'TOA net SW flux, downward positive'}//char(0))
2226     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2227     iost    = nf90\_put\_att(ncid, fsnt\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2228     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2229     iost    = nf90\_put\_att(ncid, fsnt\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2230     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2231 
2232     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"sw\_dn\_toa"}, nf90\_float, (/ time\_dim\_id /), solin\_var\_id)
2233     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2234     iost    = nf90\_put\_att(ncid, solin\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'TOA solar insolation'}//char(0))
2235     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2236     iost    = nf90\_put\_att(ncid, solin\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2237     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2238     iost    = nf90\_put\_att(ncid, solin\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2239     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2240 
2241     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"cld\_low"}, nf90\_float, (/ time\_dim\_id /), cldlow\_var\_id)
2242     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2243     iost    = nf90\_put\_att(ncid, cldlow\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Satellite-measured low cloud'}//char(0))
2244     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2245     iost    = nf90\_put\_att(ncid, cldlow\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'%'}//char(0))
2246     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2247     iost    = nf90\_put\_att(ncid, cldlow\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2248     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2249 
2250     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"cld\_mid"}, nf90\_float, (/ time\_dim\_id /), cldmed\_var\_id)
2251     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2252     iost    = nf90\_put\_att(ncid, cldmed\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Satellite-measured middle cloud'}//char(0))
2253     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2254     iost    = nf90\_put\_att(ncid, cldmed\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'%'}//char(0))
2255     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2256     iost    = nf90\_put\_att(ncid, cldmed\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2257     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2258 
2259     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"cld\_high"}, nf90\_float, (/ time\_dim\_id /), cldhgh\_var\_id)
2260     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2261     iost    = nf90\_put\_att(ncid, cldhgh\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Satellite-measured high cloud'}//char(0))
2262     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2263     iost    = nf90\_put\_att(ncid, cldhgh\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'%'}//char(0))
2264     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2265     iost    = nf90\_put\_att(ncid, cldhgh\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2266     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2267 
2268     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"cld\_tot"}, nf90\_float, (/ time\_dim\_id /), cldtot\_var\_id)
2269     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2270     iost    = nf90\_put\_att(ncid, cldtot\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Satellite-measured total cloud'}//char(0))
2271     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2272     iost    = nf90\_put\_att(ncid, cldtot\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'%'}//char(0))
2273     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2274     iost    = nf90\_put\_att(ncid, cldtot\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2275     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2276 
2277     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"cld\_thick"}, nf90\_float, (/ time\_dim\_id /), cldthk\_var\_id)
2278     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2279     iost    = nf90\_put\_att(ncid, cldthk\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Satellite-measured cloud thickness'}//char(0))
2280     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2281     iost    = nf90\_put\_att(ncid, cldthk\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'km'}//char(0))
2282     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2283     iost    = nf90\_put\_att(ncid, cldthk\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2284     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2285 
2286     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"cld\_top"}, nf90\_float, (/ time\_dim\_id /), cldtop\_var\_id)
2287     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2288     iost    = nf90\_put\_att(ncid, cldtop\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Satellite-measured cloud top'}//char(0))
2289     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2290     iost    = nf90\_put\_att(ncid, cldtop\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'km'}//char(0))
2291     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2292     iost    = nf90\_put\_att(ncid, cldtop\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2293     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2294 
2295     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"LWP"}, nf90\_float, (/ time\_dim\_id /), lwp\_var\_id)
2296     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2297     iost    = nf90\_put\_att(ncid, lwp\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'MWR-measured cloud liquid water path'}//char(0))
2298     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2299     iost    = nf90\_put\_att(ncid, lwp\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'cm'}//char(0))
2300     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2301     iost    = nf90\_put\_att(ncid, lwp\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2302     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2303 
2304     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"dh2odt\_col"}, nf90\_float, (/ time\_dim\_id /), cdh2odt\_var\_id)
2305     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2306     iost    = nf90\_put\_att(ncid, cdh2odt\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Column-integrated dH2O/dt'}//char(0))
2307     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2308     iost    = nf90\_put\_att(ncid, cdh2odt\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'mm/hour'}//char(0))
2309     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2310     iost    = nf90\_put\_att(ncid, cdh2odt\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2311     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2312 
2313     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"h2o\_adv\_col"}, nf90\_float, (/ time\_dim\_id /), ch2oadv\_var\_id)
2314     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2315     iost    = nf90\_put\_att(ncid, ch2oadv\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Column-integrated H2O advection'}//char(0))
2316     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2317     iost    = nf90\_put\_att(ncid, ch2oadv\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'mm/hour'}//char(0))
2318     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2319     iost    = nf90\_put\_att(ncid, ch2oadv\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2320     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2321 
2322     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"evap\_srf"}, nf90\_float, (/ time\_dim\_id /), evap\_var\_id)
2323     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2324     iost    = nf90\_put\_att(ncid, evap\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface evaporation'}//char(0))
2325     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2326     iost    = nf90\_put\_att(ncid, evap\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'mm/hour'}//char(0))
2327     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2328     iost    = nf90\_put\_att(ncid, evap\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2329     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2330 
2331     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"dsdt\_col"}, nf90\_float, (/ time\_dim\_id /), cdsdt\_var\_id)
2332     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2333     iost    = nf90\_put\_att(ncid, cdsdt\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Column d(dry static energy)/dt'}//char(0))
2334     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2335     iost    = nf90\_put\_att(ncid, cdsdt\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2336     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2337     iost    = nf90\_put\_att(ncid, cdsdt\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2338     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2339 
2340     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"s\_adv\_col"}, nf90\_float, (/ time\_dim\_id /), csadv\_var\_id)
2341     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2342     iost    = nf90\_put\_att(ncid, csadv\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Column dry static energy advection'}//char(0))
2343     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2344     iost    = nf90\_put\_att(ncid, csadv\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2345     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2346     iost    = nf90\_put\_att(ncid, csadv\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2347     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2348 
2349     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"rad\_heat\_col"}, nf90\_float, (/ time\_dim\_id /), crad\_var\_id)
2350     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2351     iost    = nf90\_put\_att(ncid, crad\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Column radiative heating'}//char(0))
2352     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2353     iost    = nf90\_put\_att(ncid, crad\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2354     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2355     iost    = nf90\_put\_att(ncid, crad\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2356     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2357 
2358     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"LH\_col"}, nf90\_float, (/ time\_dim\_id /), clh\_var\_id)
2359     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2360     iost    = nf90\_put\_att(ncid, clh\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Column latent heating'}//char(0))
2361     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2362     iost    = nf90\_put\_att(ncid, clh\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2363     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2364     iost    = nf90\_put\_att(ncid, clh\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2365     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2366 
2367     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"omega\_srf"}, nf90\_float, (/ time\_dim\_id /), omegas\_var\_id)
2368     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2369     iost    = nf90\_put\_att(ncid, omegas\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface omega'}//char(0))
2370     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2371     iost    = nf90\_put\_att(ncid, omegas\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'hPa/hour'}//char(0))
2372     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2373     iost    = nf90\_put\_att(ncid, omegas\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2374     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2375 
2376     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"q\_srf"}, nf90\_float, (/ time\_dim\_id /), qs\_var\_id)
2377     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2378     iost    = nf90\_put\_att(ncid, qs\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'2m water vapour mixing ratio'}//char(0))
2379     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2380     iost    = nf90\_put\_att(ncid, qs\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'kg/kg'}//char(0))
2381     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2382     iost    = nf90\_put\_att(ncid, qs\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2383     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2384 
2385     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"s\_srf"}, nf90\_float, (/ time\_dim\_id /), s2m\_var\_id)
2386     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2387     iost    = nf90\_put\_att(ncid, s2m\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'2m dry static energy'}//char(0))
2388     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2389     iost    = nf90\_put\_att(ncid, s2m\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'K'}//char(0))
2390     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2391     iost    = nf90\_put\_att(ncid, s2m\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2392     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2393 
2394     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"PW"}, nf90\_float, (/ time\_dim\_id /), pw\_var\_id)
2395     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2396     iost    = nf90\_put\_att(ncid, pw\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'MWR-measured column precipitable water'}//char(0))
2397     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2398     iost    = nf90\_put\_att(ncid, pw\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'cm'}//char(0))
2399     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2400     iost    = nf90\_put\_att(ncid, pw\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2401     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2402 
2403     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"lw\_up\_srf"}, nf90\_float, (/ time\_dim\_id /), flus\_var\_id)
2404     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2405     iost    = nf90\_put\_att(ncid, flus\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface upwelling LW'}//char(0))
2406     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2407     iost    = nf90\_put\_att(ncid, flus\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2408     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2409     iost    = nf90\_put\_att(ncid, flus\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2410     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2411 
2412     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"lw\_dn\_srf"}, nf90\_float, (/ time\_dim\_id /), flds\_var\_id)
2413     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2414     iost    = nf90\_put\_att(ncid, flds\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface downwelling LW'}//char(0))
2415     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2416     iost    = nf90\_put\_att(ncid, flds\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2417     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2418     iost    = nf90\_put\_att(ncid, flds\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2419     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2420 
2421     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"sw\_up\_srf"}, nf90\_float, (/ time\_dim\_id /), fsus\_var\_id)
2422     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2423     iost    = nf90\_put\_att(ncid, fsus\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface downwelling SW'}//char(0))
2424     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2425     iost    = nf90\_put\_att(ncid, fsus\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2426     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2427     iost    = nf90\_put\_att(ncid, fsus\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2428     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2429 
2430     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"sw\_dn\_srf"}, nf90\_float, (/ time\_dim\_id /), fsds\_var\_id)
2431     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2432     iost    = nf90\_put\_att(ncid, fsds\_var\_id, \textcolor{stringliteral}{"long\_name"}, \textcolor{stringliteral}{'Surface downwelling SW'}//char(0))
2433     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2434     iost    = nf90\_put\_att(ncid, fsds\_var\_id, \textcolor{stringliteral}{"units"}, \textcolor{stringliteral}{'W/m^2'}//char(0))
2435     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2436     iost    = nf90\_put\_att(ncid, fsds\_var\_id, \textcolor{stringliteral}{"missing\_value"}, \textcolor{keywordtype}{REAL}(-9999, kind=
      \hyperlink{namespaceportable_abaed22a509442771d3fba69bebda0b33}{rk4}))
2437     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2438 
2439     \textcolor{comment}{!}
2440     \textcolor{comment}{! Define the global attributes. The TWP-ICE stuff shouldn't be hard coded.}
2441     \textcolor{comment}{!}
2442     iost    = nf90\_put\_att(ncid, nf90\_global, \textcolor{stringliteral}{"Conventions"}, \textcolor{stringliteral}{'CF-1.0'}//char(0))
2443     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2444     iost    = nf90\_put\_att(ncid, nf90\_global, \textcolor{stringliteral}{"title"}, \textcolor{stringliteral}{'VarAnalysis 3hr SndgBased Products V1.1: TWP-ICE'}//
      char(0))
2445     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2446     \textcolor{keyword}{CALL }date\_and\_time(values=date\_time)
2447     \textcolor{keyword}{WRITE}(unit=tmpstr, fmt=\textcolor{stringliteral}{'(I4.4,"-",I2.2,"-",I2.2,"T",I2.2,":",I2.2,":",I2.2,".",I3.3,SP,I5)'}) &
2448         & date\_time(1), date\_time(2), date\_time(3), date\_time(5), date\_time(6), date\_time(7), date\_time(8),
       date\_time(4)
2449     iost    = nf90\_put\_att(ncid, nf90\_global, \textcolor{stringliteral}{"date\_created"}, tmpstr//char(0))
2450     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2451     iost    = nf90\_put\_att(ncid, nf90\_global, \textcolor{stringliteral}{"software"}, \textcolor{stringliteral}{'Fortran 95 variational analysis software'}//char(
      0))
2452     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2453 
2454     \textcolor{comment}{!}
2455     \textcolor{comment}{! We've finished defining stuff, leave the definition mode.}
2456     \textcolor{comment}{!}
2457     iost    = nf90\_enddef(ncid)
2458     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2459 
2460     \textcolor{comment}{!}
2461     \textcolor{comment}{! Write the data.}
2462     \textcolor{comment}{!}
2463     iost    = nf90\_put\_var(ncid, base\_time\_var\_id, \textcolor{keywordtype}{REAL(DATE\_TIME\_TO\_UNIX(YYYY=INT(SFC\_DATA(2,1),
       KIND=IK4), &
        & MO=INT(SFC\_DATA(3,1), KIND=IK4), DD=INT(SFC\_DATA(4,1), KIND=IK4), HH=INT(SFC\_DATA(5,1), KIND=IK4)}
      , &
2464         & MM=INT(SFC\_DATA(6,1), KIND=IK4))-SFC\_DATA(1,1)*86400, KIND=RK8))
2465     if (iost .NE. nf90\_noerr) go to 9999
2466 
2467     iost    = nf90\_put\_var(ncid,    time\_var\_id,        sfc\_data(1,:))
2468     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2469     iost    = nf90\_put\_var(ncid,    time\_offset\_var\_id, (sfc\_data(1,:) - sfc\_data(1,1))*86400.)
2470     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2471     iost    = nf90\_put\_var(ncid,    year\_var\_id,        sfc\_data(2,:))
2472     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2473     iost    = nf90\_put\_var(ncid,    month\_var\_id,       sfc\_data(3,:))
2474     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2475     iost    = nf90\_put\_var(ncid,    day\_var\_id,         sfc\_data(4,:))
2476     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2477     iost    = nf90\_put\_var(ncid,    hour\_var\_id,        sfc\_data(5,:))
2478     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2479     iost    = nf90\_put\_var(ncid,    minute\_var\_id,      sfc\_data(6,:))
2480     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2481     iost    = nf90\_put\_var(ncid,    lat\_var\_id,         cf\_lat)
2482     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2483     iost    = nf90\_put\_var(ncid,    lon\_var\_id,         cf\_lon)
2484     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2485     iost    = nf90\_put\_var(ncid,    phis\_var\_id,        cf\_phis)
2486     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2487     iost    = nf90\_put\_var(ncid,    lev\_var\_id,         plevs)
2488     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2489 
2490     iost    = nf90\_put\_var(ncid,    temp\_var\_id,        ml\_data(1,:,:)) 
2491     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2492     iost    = nf90\_put\_var(ncid,    q\_var\_id,           ml\_data(2,:,:))
2493     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2494     iost    = nf90\_put\_var(ncid,    u\_var\_id,           ml\_data(3,:,:))
2495     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2496     iost    = nf90\_put\_var(ncid,    v\_var\_id,           ml\_data(4,:,:))
2497     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2498     iost    = nf90\_put\_var(ncid,    omega\_var\_id,       ml\_data(5,:,:))
2499     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2500     iost    = nf90\_put\_var(ncid,    div\_var\_id,         ml\_data(6,:,:))
2501     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2502     iost    = nf90\_put\_var(ncid,    tadvh\_var\_id,       ml\_data(7,:,:))
2503     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2504     iost    = nf90\_put\_var(ncid,    tadvv\_var\_id,       ml\_data(8,:,:))
2505     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2506     iost    = nf90\_put\_var(ncid,    qadvh\_var\_id,       ml\_data(9,:,:))
2507     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2508     iost    = nf90\_put\_var(ncid,    qadvv\_var\_id,       ml\_data(10,:,:))
2509     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2510     iost    = nf90\_put\_var(ncid,    s\_var\_id,           ml\_data(11,:,:))
2511     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2512     iost    = nf90\_put\_var(ncid,    sadvh\_var\_id,       ml\_data(12,:,:))
2513     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2514     iost    = nf90\_put\_var(ncid,    sadvv\_var\_id,       ml\_data(13,:,:))
2515     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2516     iost    = nf90\_put\_var(ncid,    dsdt\_var\_id,        ml\_data(14,:,:))
2517     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2518     iost    = nf90\_put\_var(ncid,    dtdt\_var\_id,        ml\_data(15,:,:))
2519     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2520     iost    = nf90\_put\_var(ncid,    dqdt\_var\_id,        ml\_data(16,:,:))
2521     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2522     iost    = nf90\_put\_var(ncid,    q1\_var\_id,          ml\_data(17,:,:))
2523     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2524     iost    = nf90\_put\_var(ncid,    q2\_var\_id,          ml\_data(18,:,:))
2525     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2526 
2527     iost    = nf90\_put\_var(ncid,    prec\_var\_id,        sfc\_data(7,:))
2528     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2529     iost    = nf90\_put\_var(ncid,    lh\_var\_id,          sfc\_data(8,:))
2530     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2531     iost    = nf90\_put\_var(ncid,    sh\_var\_id,          sfc\_data(9,:))
2532     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2533     iost    = nf90\_put\_var(ncid,    psa\_var\_id,         sfc\_data(10,:))
2534     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2535     iost    = nf90\_put\_var(ncid,    psi\_var\_id,         sfc\_data(11,:))
2536     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2537     iost    = nf90\_put\_var(ncid,    tsair\_var\_id,       sfc\_data(12,:))
2538     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2539     iost    = nf90\_put\_var(ncid,    tskin\_var\_id,       sfc\_data(13,:))
2540     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2541     iost    = nf90\_put\_var(ncid,    rhair\_var\_id,       sfc\_data(14,:))
2542     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2543     iost    = nf90\_put\_var(ncid,    wspd\_var\_id,        sfc\_data(15,:))
2544     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2545     iost    = nf90\_put\_var(ncid,    us\_var\_id,          sfc\_data(16,:))
2546     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2547     iost    = nf90\_put\_var(ncid,    vs\_var\_id,          sfc\_data(17,:))
2548     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2549     iost    = nf90\_put\_var(ncid,    srfrad\_var\_id,      sfc\_data(18,:))
2550     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2551     iost    = nf90\_put\_var(ncid,    flut\_var\_id,        sfc\_data(19,:))
2552     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2553     iost    = nf90\_put\_var(ncid,    fsnt\_var\_id,        sfc\_data(20,:))
2554     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2555     \textcolor{comment}{!IOST    = NF90\_PUT\_VAR(NCID,    SOLIN\_VAR\_ID,       SFC\_DATA(21,:))}
2556     \textcolor{comment}{!IF (IOST .NE. NF90\_NOERR) GO TO 9999}
2557     iost    = nf90\_put\_var(ncid,    cldlow\_var\_id,      sfc\_data(22,:))
2558     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2559     iost    = nf90\_put\_var(ncid,    cldmed\_var\_id,      sfc\_data(23,:))
2560     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2561     iost    = nf90\_put\_var(ncid,    cldhgh\_var\_id,      sfc\_data(24,:))
2562     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2563     iost    = nf90\_put\_var(ncid,    cldtot\_var\_id,      sfc\_data(25,:))
2564     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2565     iost    = nf90\_put\_var(ncid,    cldthk\_var\_id,      sfc\_data(26,:))
2566     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2567     iost    = nf90\_put\_var(ncid,    cldtop\_var\_id,      sfc\_data(27,:))
2568     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2569     iost    = nf90\_put\_var(ncid,    lwp\_var\_id,         sfc\_data(28,:))
2570     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2571     iost    = nf90\_put\_var(ncid,    cdh2odt\_var\_id,     sfc\_data(29,:))
2572     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2573     iost    = nf90\_put\_var(ncid,    ch2oadv\_var\_id,     sfc\_data(30,:))
2574     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2575     iost    = nf90\_put\_var(ncid,    evap\_var\_id,        sfc\_data(31,:))
2576     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2577     iost    = nf90\_put\_var(ncid,    cdsdt\_var\_id,       sfc\_data(32,:))
2578     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2579     iost    = nf90\_put\_var(ncid,    csadv\_var\_id,       sfc\_data(33,:))
2580     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2581     iost    = nf90\_put\_var(ncid,    crad\_var\_id,        sfc\_data(34,:))
2582     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2583     iost    = nf90\_put\_var(ncid,    clh\_var\_id,         sfc\_data(35,:))
2584     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2585     iost    = nf90\_put\_var(ncid,    omegas\_var\_id,      sfc\_data(36,:))
2586     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2587     iost    = nf90\_put\_var(ncid,    qs\_var\_id,          sfc\_data(37,:))
2588     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2589     iost    = nf90\_put\_var(ncid,    s2m\_var\_id,         sfc\_data(38,:))
2590     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2591     iost    = nf90\_put\_var(ncid,    pw\_var\_id,          sfc\_data(39,:))
2592     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2593     iost    = nf90\_put\_var(ncid,    flus\_var\_id,        sfc\_data(40,:))
2594     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2595     iost    = nf90\_put\_var(ncid,    flds\_var\_id,        sfc\_data(41,:))
2596     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2597     iost    = nf90\_put\_var(ncid,    fsus\_var\_id,        sfc\_data(42,:))
2598     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2599     iost    = nf90\_put\_var(ncid,    fsds\_var\_id,        sfc\_data(43,:))
2600     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2601 
2602     \textcolor{comment}{!}
2603     \textcolor{comment}{! Close the NetCDF file.}
2604     \textcolor{comment}{!}
2605     iost    = nf90\_close(ncid)
2606     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
2607 
2608     \textcolor{comment}{!}
2609     \textcolor{comment}{! Catch any NetCDF errors here.}
2610     \textcolor{comment}{!}
2611     9999 \textcolor{keywordflow}{CONTINUE}
2612     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
2613         print *,\textcolor{stringliteral}{'E: Problem creating NetCDF file '},outputfile
2614         print *, trim(nf90\_strerror(iost))
2615         stop \textcolor{stringliteral}{'1'}
2616 \textcolor{keywordflow}{    END IF}
2617 
2618 \end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=325pt]{namespaceio_a50ab1073758d8d341087a0755354011d_icgraph}
\end{center}
\end{figure}


\index{io@{io}!opt\+\_\+vht\+\_\+netcdf@{opt\+\_\+vht\+\_\+netcdf}}
\index{opt\+\_\+vht\+\_\+netcdf@{opt\+\_\+vht\+\_\+netcdf}!io@{io}}
\subsubsection[{\texorpdfstring{opt\+\_\+vht\+\_\+netcdf(\+O\+U\+T\+P\+U\+T\+F\+I\+L\+E, I\+N\+S\+T\+R\+U\+M\+E\+N\+T, N\+V, N\+P, N\+S\+T, N\+T, V, P, S\+T, T, D)}{opt_vht_netcdf(OUTPUTFILE, INSTRUMENT, NV, NP, NST, NT, V, P, ST, T, D)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine io\+::opt\+\_\+vht\+\_\+netcdf (
\begin{DoxyParamCaption}
\item[{character (len=$\ast$), intent(in)}]{O\+U\+T\+P\+U\+T\+F\+I\+LE, }
\item[{character (len=$\ast$), intent(in)}]{I\+N\+S\+T\+R\+U\+M\+E\+NT, }
\item[{integer (kind=ik4), intent(in)}]{NV, }
\item[{integer (kind=ik4), intent(in)}]{NP, }
\item[{integer (kind=ik4), intent(in)}]{N\+ST, }
\item[{integer (kind=ik4), intent(in)}]{NT, }
\item[{character (len=$\ast$), dimension(nv), intent(in)}]{V, }
\item[{real (kind=rk8), dimension(np), intent(in)}]{P, }
\item[{character (len=$\ast$), dimension(nst), intent(in)}]{ST, }
\item[{real (kind=rk8), dimension(nt), intent(in)}]{T, }
\item[{real (kind=rk8), dimension(nv,np,nst,nt), intent(in)}]{D}
\end{DoxyParamCaption}
)}\hypertarget{namespaceio_a1feb605e982e6696d29a63e635b8d3e1}{}\label{namespaceio_a1feb605e982e6696d29a63e635b8d3e1}


Definition at line 265 of file io.\+f90.


\begin{DoxyCode}
265     \textcolor{keywordtype}{USE }\hyperlink{namespaceportable}{portable}
266     \textcolor{keywordtype}{USE }netcdf
267 
268     \textcolor{keywordtype}{IMPLICIT NONE}
269 
270     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: outputfile   \textcolor{comment}{! Name of the
       output file.}
271     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{INTENT(IN)}                                       :: instrument   \textcolor{comment}{! Instrument name.}
272     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}                                      :: nv           \textcolor{comment}{! Number of
       variables?}
273     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}                                      :: np           \textcolor{comment}{! Number of
       pressure levels.}
274     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}                                      :: nst          \textcolor{comment}{! Number of
       stations.}
275     \textcolor{keywordtype}{INTEGER (KIND=IK4)}, \textcolor{keywordtype}{INTENT(IN)}                                      :: nt           \textcolor{comment}{! Number of time
       steps.}
276     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{DIMENSION(NV)},  \textcolor{keywordtype}{INTENT(IN)}                       :: v            \textcolor{comment}{! Variable names?}
277     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(NP)}, \textcolor{keywordtype}{INTENT(IN)}                          :: p            \textcolor{comment}{! Values of the
       pressure levels.}
278     \textcolor{keywordtype}{CHARACTER (LEN=*)}, \textcolor{keywordtype}{DIMENSION(NST)}, \textcolor{keywordtype}{INTENT(IN)}                       :: st           \textcolor{comment}{! Station names?}
279     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(NT)}, \textcolor{keywordtype}{INTENT(IN)}                          :: t            \textcolor{comment}{! Time values?}
280     \textcolor{keywordtype}{REAL (KIND=RK8)}, \textcolor{keywordtype}{DIMENSION(NV,NP,NST,NT)}, \textcolor{keywordtype}{INTENT(IN)}                :: d            \textcolor{comment}{! The data.}
281 
282     \textcolor{comment}{!}
283     \textcolor{comment}{! Local variables.}
284     \textcolor{comment}{!}
285     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ncid                                                 \textcolor{comment}{! ID of NetCDF
       file.}
286     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: v\_dim\_id, p\_dim\_id, st\_dim\_id, t\_dim\_id, str\_dim\_id  \textcolor{comment}{! Dimension IDs.}
287     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: v\_var\_id, p\_var\_id, st\_var\_id, t\_var\_id, data\_var\_id \textcolor{comment}{! Variable IDs.}
288     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: iost                                                 \textcolor{comment}{! I/O status.}
289     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: ii                                                   \textcolor{comment}{! Counter.}
290     \textcolor{keywordtype}{INTEGER (KIND=IK4)}          :: strlen                                               \textcolor{comment}{! String length.}
291     \textcolor{keywordtype}{CHARACTER (LEN=64)}          :: tmpstr                                               \textcolor{comment}{! Temporary string.}
292 
293     iost    = nf90\_noerr
294     \textcolor{comment}{!}
295     \textcolor{comment}{! Create the NetCDF file.}
296     \textcolor{comment}{!}
297     iost    = nf90\_create(outputfile, nf90\_noclobber, ncid)
298     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
299 
300     \textcolor{comment}{!}
301     \textcolor{comment}{! Define the dimensions.}
302     \textcolor{comment}{!}
303     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"variables"}, nv, v\_dim\_id)     \textcolor{comment}{! The data array contains many variables.}
304     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
305 
306     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"levels"}, np, p\_dim\_id)        \textcolor{comment}{! Vertical levels.}
307     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
308 
309     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"stations"}, nst, st\_dim\_id)    \textcolor{comment}{! Stations.}
310     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
311 
312     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"time"}, nt, t\_dim\_id)          \textcolor{comment}{! Time steps.}
313     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
314 
315     iost    = nf90\_def\_dim(ncid, \textcolor{stringliteral}{"string"}, 64, str\_dim\_id)      \textcolor{comment}{! This dimension is used for character
       strings.}
316     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
317 
318     \textcolor{comment}{!}
319     \textcolor{comment}{! Define the variables.}
320     \textcolor{comment}{!}
321     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"variables"}, nf90\_char, (/ str\_dim\_id, v\_dim\_id /), v\_var\_id)
322     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
323 
324     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"levels"}, nf90\_double, (/ p\_dim\_id /), p\_var\_id)
325     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
326 
327     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"stations"}, nf90\_char, (/ str\_dim\_id, st\_dim\_id /), st\_var\_id)
328     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
329 
330     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"time"}, nf90\_double, (/ t\_dim\_id /), t\_var\_id)
331     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
332 
333     iost    = nf90\_def\_var(ncid, \textcolor{stringliteral}{"data"}, nf90\_double, (/ v\_dim\_id, p\_dim\_id, st\_dim\_id, t\_dim\_id /), 
      data\_var\_id)
334     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
335 
336     \textcolor{comment}{!}
337     \textcolor{comment}{! Write the instrument type as a global attribute. Make sure the string is null terminated (for C
       programs).}
338     \textcolor{comment}{!}
339     iost    = nf90\_put\_att(ncid, nf90\_global, \textcolor{stringliteral}{"instrument"}, trim(instrument)//char(0))
340     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
341 
342     \textcolor{comment}{!}
343     \textcolor{comment}{! We've finished defining stuff, leave the definition mode.}
344     \textcolor{comment}{!}
345     iost    = nf90\_enddef(ncid)
346     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
347 
348     \textcolor{comment}{!}
349     \textcolor{comment}{! Write the names of the variables. Terminate strings with a null byte, in case the data are
       subsequently read by a C program.}
350     \textcolor{comment}{!}
351     \textcolor{keywordflow}{DO} ii=1,nv
352         tmpstr  = trim(v(ii))
353         strlen  = min(63, len\_trim(tmpstr))           \textcolor{comment}{! The characters after this positon will be replaced
       by null characters.}
354         tmpstr(strlen+1:64)    = repeat(char(0), 64-strlen)
355         iost    = nf90\_put\_var(ncid, v\_var\_id, tmpstr, (/ 1, ii /), (/ 64, 1 /))
356         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
357 \textcolor{keywordflow}{    END DO}
358 
359     \textcolor{comment}{!}
360     \textcolor{comment}{! Write the names of the stations. Terminate strings with a null byte, in case the data are
       subsequently read by a C program.}
361     \textcolor{comment}{!}
362     \textcolor{keywordflow}{DO} ii=1,nst
363         tmpstr  = trim(st(ii))
364         strlen  = min(63, len\_trim(tmpstr))           \textcolor{comment}{! The characters after this positon will be replaced
       by null characters.}
365         tmpstr(strlen+1:64)    = repeat(char(0) , 64-strlen)
366         iost    = nf90\_put\_var(ncid, st\_var\_id, tmpstr, (/ 1, ii /), (/ 64, 1 /))
367         \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
368 \textcolor{keywordflow}{    END DO}
369 
370     \textcolor{comment}{!}
371     \textcolor{comment}{! Write the pressure levels.}
372     \textcolor{comment}{!}
373     iost    = nf90\_put\_var(ncid, p\_var\_id, p)
374     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
375 
376     \textcolor{comment}{!}
377     \textcolor{comment}{! Write the time steps.}
378     \textcolor{comment}{!}
379     iost    = nf90\_put\_var(ncid, t\_var\_id, t)
380     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
381 
382     \textcolor{comment}{!}
383     \textcolor{comment}{! Write the big data array.}
384     \textcolor{comment}{!}
385     iost    = nf90\_put\_var(ncid, data\_var\_id, d)
386     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
387 
388     \textcolor{comment}{!}
389     \textcolor{comment}{! Close the NetCDF file.}
390     \textcolor{comment}{!}
391     iost    = nf90\_close(ncid)
392     \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{GO TO} 9999
393 
394     \textcolor{comment}{!}
395     \textcolor{comment}{! Catch any NetCDF errors here.}
396     \textcolor{comment}{!}
397     9999 \textcolor{keywordflow}{IF} (iost .NE. nf90\_noerr) \textcolor{keywordflow}{THEN}
398         print *,\textcolor{stringliteral}{'E: Problem creating NetCDF file '},outputfile
399         print *, trim(nf90\_strerror(iost))
400         stop \textcolor{stringliteral}{'1'}
401 \textcolor{keywordflow}{    END IF}
402 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{namespaceio_a1feb605e982e6696d29a63e635b8d3e1_icgraph}
\end{center}
\end{figure}


